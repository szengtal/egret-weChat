var egret=window.egret,__reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{h(n.next(e))}catch(t){r(t)}}function s(e){try{h(n["throw"](e))}catch(t){r(t)}}function h(e){e.done?o(e.value):new i(function(t){t(e.value)}).then(a,s)}h((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,r&&(a=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,r=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(a=h.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){h.label=i[1];break}if(6===i[0]&&h.label<a[1]){h.label=a[1],a=i;break}if(a&&h.label<a[2]){h.label=a[2],h.ops.push(i);break}a[2]&&h.ops.pop(),h.trys.pop();continue}i=t.call(e,h)}catch(n){i=[6,n],r=0}finally{o=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,r,a,s,h={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},Dictionary=function(){function e(){this._count=0,this._maps={},this._hashMaps={},this._objKeys=[],this._objDatum=[]}return e.prototype.add=function(e,t){if("object"!=typeof e)this._maps[e]||this._count++,this._maps[e]=t;else if(e instanceof egret.HashObject)this._hashMaps[e.hashCode]||this._count++,this._hashMaps[e.hashCode]=[e,t];else{var i=this._objKeys.lastIndexOf(e);-1==i?(this._objKeys.push(e),this._objDatum.push(t),this._count++):this._objDatum[i]=t}},e.prototype.del=function(e){var t;"object"!=typeof e?this._maps[e]&&(delete this._maps[e],this._count--):e instanceof egret.HashObject?this._hashMaps[e.hashCode]&&(delete this._hashMaps[e.hashCode],this._count--):(t=this._objKeys.lastIndexOf(e),-1!=t&&(this._objKeys.splice(t,1),this._objDatum.splice(t,1),this._count--))},e.prototype.get=function(e){if("object"!=typeof e)return this._maps[e]?this._maps[e]:null;if(e instanceof egret.HashObject)return this._hashMaps[e.hashCode]?this._hashMaps[e.hashCode][1]:null;var t=this._objKeys.lastIndexOf(e);return-1!=t?this._objDatum[t]:null},e.prototype.has=function(e){if("object"!=typeof e)return this._maps[e]?!0:!1;if(e instanceof egret.HashObject)return this._hashMaps[e.hashCode]?!0:!1;var t=this._objKeys.lastIndexOf(e);return-1!=t?!0:!1},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e,t){void 0===t&&(t=null);var i,n;for(i in this._maps)e.call(t,i,this._maps[i]);for(i in this._hashMaps)n=this._hashMaps[i],e.call(t,n[0],n[1]);for(var o=0;o<this._objKeys.length;o++){var r=this._objKeys[o];e.call(t,this._objKeys[o],this._objDatum[o]),r!=this._objKeys[o]&&o--}},Object.defineProperty(e.prototype,"elements",{get:function(){var e,t,i=[];for(e in this._maps)i.push({key:e,data:this._maps[e]});for(e in this._hashMaps)t=this._hashMaps[e],i.push({key:t[0],data:t[1]});for(var n=this._objKeys.length,o=0;n>o;o++)i.push({key:this._objKeys[o],data:this._objDatum[o]});return i},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){var e,t=[];for(e in this._maps)t.push(e);for(e in this._hashMaps)t.push(this._hashMaps[e][0]);return t=t.concat(this._objKeys)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"datum",{get:function(){var e,t=[];for(e in this._maps)t.push(this._maps[e]);for(e in this._hashMaps)t.push(this._hashMaps[e][1]);return t=t.concat(this._objDatum)},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this._maps={},this._hashMaps={},this._objKeys.length=0,this._objDatum.length=0},e.prototype.dump=function(){var e,t;for(e in this._maps)console.log("key:",e,"---> data:",this._maps[e]);for(e in this._hashMaps)t=this._hashMaps[e],console.log("key:",t[0],"---> data:",t[1]);for(var i=this._objKeys.length,n=0;i>n;n++)console.log("key:",typeof this._objKeys[n]," ---> data:",this._objDatum[n])},e}();__reflect(Dictionary.prototype,"Dictionary");var weChat;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.initUI(),e}return __extends(i,t),i.prototype.initUI=function(){},i.prototype.showDataLoading=function(t,i){this._dataLoading||(this._dataLoading=new e.DataLoading,t?this._dataLoading.x=t:this._dataLoading.x=Math.round(this.width/2),i?this._dataLoading.y=i:this._dataLoading.y=Math.round(this.height/2),this.addChild(this._dataLoading),this._dataLoading.play())},i.prototype.removeLoading=function(){this._dataLoading&&(this._dataLoading.destory(),this._dataLoading=null)},i.prototype.destory=function(){e.LobbyResUtil.removeFromParent(this),e.LobbyResUtil.removeAllChildren(this),this.removeLoading()},i}(egret.DisplayObjectContainer);e.LobbyBaseVc=t,__reflect(t.prototype,"weChat.LobbyBaseVc")}(weChat||(weChat={}));var weChat;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init(),this.addEvent()},t.prototype.init=function(){this._panelBg&&(this._panelBg.scale9Grid=new egret.Rectangle(160,150,960,502))},t.prototype.addEvent=function(){},t.prototype.removeEvent=function(){},t.prototype.destory=function(){this.removeEvent()},t}(eui.Component);e.BaseEuiPanel=t,__reflect(t.prototype,"weChat.BaseEuiPanel",["weChat.EuiSkinInt"])}(weChat||(weChat={}));var uniLib;!function(e){var t=function(){function t(){}return t.setLocalStorage=function(t,i){e.Global.nativeStorage?e.Global.nativeStorage.save({key:t,id:t,rawData:i,expires:null}):window.localStorage?localStorage.setItem(t,i):window.document&&window.document.cookie||egret&&egret.localStorage.setItem(t,i)},t.getLocalStorage=function(t,i){if(e.Global.nativeStorage)e.Global.nativeStorage.load({key:t,id:t,autoSync:!0,syncInBackground:!0}).then(function(e){i(e)})["catch"](function(e){i(null)});else if(window.localStorage){if(!i)return localStorage.getItem(t);i(localStorage.getItem(t))}else if(window.document&&window.document.cookie);else if(egret){if(!i)return egret.localStorage.getItem(t);i(egret.localStorage.getItem(t))}else{if(!i)return null;i(null)}},t.clearLocalStorage=function(t){try{if(1==e.Global.lobbyMode&&1==e.Global.isInGame)return;t?e.Global.nativeStorage?e.Global.nativeStorage.remove({key:t}):window.localStorage?localStorage.removeItem(t):window.document&&window.document.cookie||egret&&egret.localStorage.removeItem(t):e.Global.nativeStorage?e.Global.nativeStorage.clearMap():window.localStorage?localStorage.clear():window.document&&window.document.cookie||egret&&egret.localStorage.clear()}catch(i){}},t.isIOS=function(){return 0==e.Global.isH5&&"iOS"==egret.Capabilities.os?!0:!1},t.isAndroid=function(){return 0==e.Global.isH5&&"Android"==egret.Capabilities.os?!0:!1},t.restart=function(t,i,n){var o=this;o.isrebooting;if(o.isrebooting=!0,1==e.Global.isH5){var r=confirm(t);1==r?""!=e.Global.reLoginUrl:(o.isrebooting=!1,alert("取消重启"))}},t.getDistance=function(e,t,i,n){if(Math.abs(e)>90||Math.abs(i)>90)return 0;if(Math.abs(t)>180||Math.abs(n)>180)return 0;var o=this.rad(e),r=this.rad(i),a=o-r,s=this.rad(t)-this.rad(n),h=2*Math.asin(Math.sqrt(Math.pow(Math.sin(a/2),2)+Math.cos(o)*Math.cos(r)*Math.pow(Math.sin(s/2),2)));return h*=this.EARTH_RADIUS,h=Math.round(1e4*h)/1e4},t.rad=function(e){return e*Math.PI/180},t.isrebooting=!1,t.EARTH_RADIUS=6378137,t}();e.Utils=t,__reflect(t.prototype,"uniLib.Utils")}(uniLib||(uniLib={}));var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,n){function o(e){t.call(n,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(n,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var weChat;!function(e){var t=function(){function e(){}return e}();e.EventData=t,__reflect(t.prototype,"weChat.EventData")}(weChat||(weChat={}));var weChat;!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.DATA_CHANGE="data_changes",t.CLOSE="close",t.ENTER_STANDARD="enter_standard",t.BACK_MAINSCENE="back_mianscene",t.LOBBY_SHOW_HELP="lobby_show_help",t.RESET_MAN_POSITION="reset_man_position",t.TURN_LEFT="turn_left",t.TURN_RIGHT="turn_right",t.PILES_CHANGE="piles_change",t.RE_START="re_start",t.SHOW_RESTART_PANEL="show_restart_panel",t.SHOW_RANK="show_rank",t.CONFIRM="confirm",t}(egret.Event);e.LobbyUIEventConsts=t,__reflect(t.prototype,"weChat.LobbyUIEventConsts")}(weChat||(weChat={}));var weChat;!function(e){var t=function(){function e(){}return e.defaultWidth=720,e.defaultHeight=1280,e.version="1.0.0",e.shareNLast=0,e}();e.LobbyDataCache=t,__reflect(t.prototype,"weChat.LobbyDataCache")}(weChat||(weChat={}));var weChat;!function(e){var t=function(){function t(){}return t.addPopUp=function(t,i,n,o,r,a,s,h){if(void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===r&&(r=!0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===h&&(h=!1),e.variableCommon.getInstance().LobbyPopMap.has(t[0]))return void console.error("该面板已经存在");""!=t[0]&&(e.variableCommon.getInstance().LobbyPopMap.set(t[0],t[1]),e.variableCommon.getInstance().LobbyPopArray.push({_this:t[1],fun:t[0]}));var l=new egret.Sprite;l.graphics.beginFill(0,.6),l.graphics.drawRect(0,0,uniLib.Global.screenWidth,1*uniLib.Global.screenHeight),l.graphics.endFill(),l.touchEnabled=!0,l.name=i.hashCode+"_mask",n?l.visible=!0:l.visible=!1,egret.MainContext.instance.stage.addChild(i);var c,u;o?(c=a?e.LobbyDataCache.defaultWidth-a>>1:e.LobbyDataCache.defaultWidth-i.width>>1,u=s?(e.LobbyDataCache.defaultHeight-s)/2:(e.LobbyDataCache.defaultHeight-i.height)/2):(c=i.x,u=i.y),h&&l.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.dispatchEventWith(e.LobbyUIEventConsts.CLOSE)},this),r&&(i.alpha=0,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.scaleX=.6,i.scaleY=.6,i.x+=i.width/2,i.y+=i.height/2,egret.Tween.removeTweens(i),egret.Tween.get(i).to({alpha:1,scaleX:1.1,scaleY:1.1},200,egret.Ease.backOut).to({scaleX:1,scaleY:1},100))},t.removePopUp=function(t,i,n,o){void 0===n&&(n=!1),void 0===o&&(o=!0),e.variableCommon.getInstance().removeOne(t,e.variableCommon.getInstance().LobbyPopMap.get(t)),e.variableCommon.getInstance().LobbyPopMap.has(t)&&e.variableCommon.getInstance().LobbyPopMap["delete"](t);var r;r=i.parent?i.parent.getChildByName(i.hashCode+"_mask"):this.getContainer().getChildByName(i.hashCode+"_mask"),r&&(egret.Tween.removeTweens(i),r.removeEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.dispatchEventWith(e.LobbyUIEventConsts.CLOSE)},this),uniLib.DisplayUtils.removeFromParent(r),r=null),n?(egret.Tween.removeTweens(i),egret.Tween.get(i).to({alpha:0},200).call(this.removeTarget,this,[i])):i.parent&&i.parent.removeChild(i)},t.removeTarget=function(e){e.alpha=1,egret.Tween.removeTweens(e),e.parent&&e.parent.removeChild(e)},t.showMildWarnShow=function(t){if(e.LobbyResUtil.trace("轻度提示："+t),t){e.variableCommon.getInstance().LobbyTempMap.set(t,0);var i=new e.LobbyMildAlertVC;if(i.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeStage,this),i.setText(t),egret.MainContext.instance.stage.addChild(i),this.showList.length>0)for(var n=0;n<this.showList.length;n++)this.showList[n].y-=i.height;this.showList.push(i)}},t.removeStage=function(t){var i=t.currentTarget;i.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeStage,this),this.showList.splice(this.showList.indexOf(i),1),e.variableCommon.getInstance().LobbyTempMap.clear()},t.getContainer=function(){return egret.MainContext.instance.stage},t.showConfirmPanel=function(t,i,n,o,r,a,s,h,l){void 0===n&&(n=null),void 0===o&&(o=null),void 0===a&&(a=0),void 0===s&&(s=!1),void 0===l&&(l=egret.HorizontalAlign.CENTER);var c=new e.LobbyMsgBox(s);o||(o=""),c.setData(o,t,i,n,r,a,h,l),BC.addEvent(this,c,e.LobbyUIEventConsts.CLOSE,this._msgTipscloseHander),c.x=Math.round((e.LobbyDataCache.defaultWidth-c.width)/2),c.y=Math.round((e.LobbyDataCache.defaultHeight-c.height)/2),this.addPopUp(["",this],c,!0,!0,!0,0,0,!1)},t._msgTipscloseHander=function(e){},t.showList=[],t.showListStr=new Map,t}();e.LobbyPopupManager=t,__reflect(t.prototype,"weChat.LobbyPopupManager")}(weChat||(weChat={}));var BC=function(){function e(){}return e.addEvent=function(t,i,n,o,r,a,s){void 0===r&&(r=!1),void 0===a&&(a=0),void 0===s&&(s=!1),i&&t&&n&&o||console.error("添加事件监听参数缺少:",e.addEvent.arguments),i.addEventListener(n,o,t,r,a,s),e.instances.push([t,i,n,o,r,a,s])},e.addOnceEvent=function(t,i,n,o,r,a,s){void 0===r&&(r=!1),void 0===a&&(a=0),void 0===s&&(s=!1),e.addEvent(t,i,n,o,r,a,s);var h=function(a){e.removeEvent(t,i,n,h,r),e.removeEvent(t,i,n,o,r)};e.addEvent(t,i,n,h,r,a,s)},e.removeEvent=function(t,i,n,o,r){if(void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===r&&(r=!1),!t)return void console.error("监听者参数不能为空！",e.removeEvent.arguments);var a,s,h,l,c=e.instanceslib,u=0,d=!0;i?u|=4:0,n?u|=2:0,o?u|=1:0;var p,g,f=function(){switch(d=!0,u){case 0:a[e.DISPATHCH].removeEventListener(a[e.EVENT],a[e.FUNCTION],t,a[e.USECAPTURE]);break;case 1:a[e.FUNCTION]==o?a[e.DISPATHCH].removeEventListener(a[e.EVENT],a[e.FUNCTION],t,a[e.USECAPTURE]):d=!1;break;case 2:a[e.EVENT]==n?a[e.DISPATHCH].removeEventListener(a[e.EVENT],a[e.FUNCTION],t,a[e.USECAPTURE]):d=!1;break;case 3:a[e.EVENT]==n&&a[e.FUNCTION]==o?a[e.DISPATHCH].removeEventListener(a[e.EVENT],a[e.FUNCTION],t,a[e.USECAPTURE]):d=!1;break;case 4:a[e.DISPATHCH]==i?a[e.DISPATHCH].removeEventListener(a[e.EVENT],a[e.FUNCTION],t,a[e.USECAPTURE]):d=!1;break;case 5:a[e.DISPATHCH]==i&&a[e.FUNCTION]==o?a[e.DISPATHCH].removeEventListener(a[e.EVENT],a[e.FUNCTION],t,a[e.USECAPTURE]):d=!1;break;case 6:a[e.DISPATHCH]==i&&a[e.EVENT]==n?a[e.DISPATHCH].removeEventListener(a[e.EVENT],a[e.FUNCTION],t,a[e.USECAPTURE]):d=!1;break;case 7:a[e.DISPATHCH]==i&&a[e.EVENT]==n&&a[e.FUNCTION]==o?a[e.DISPATHCH].removeEventListener(n,o,t,r):d=!1}};if(s=c.get(t)){for(p=s.length,g=p-1;g>=0;g--)a=s[g],f(),d&&s.splice(g,1);s.length||c.del(t)}for(s=e.instances,p=s.length,s=s.reverse(),g=p-1;g>=0;g--)a=s[g],a[e.KEY]==t?f():d=!1,d?s.pop():h==a[e.KEY]?l.push(s.pop()):(h=s[s.length-1][e.KEY],l=c.get(h),l?l.push(s.pop()):(l=[s.pop()],c.add(a[e.KEY],l)))},e.instanceslib=new Dictionary,e.instances=[],e.KEY=0,e.DISPATHCH=1,e.EVENT=2,e.FUNCTION=3,e.USECAPTURE=4,e.PRIORITY=5,e.USEWEAKREFERENCE=6,e}();__reflect(BC.prototype,"BC");var DelegateUtil=function(){function e(){}return e.create=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(!t)throw"没有可代理的函数.";var o=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];t.apply(e,n.concat(i)),e=null};return o},e.createFilterOriginalParameters=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(!t)throw"没有可代理的函数.";var o=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];t.apply(e,i)};return o},e}();__reflect(DelegateUtil.prototype,"DelegateUtil");var Demo=function(e){function t(){function t(e){var t;switch(e){case 1:t=new egret.HashObject,t.name="我是对象";break;case 2:t.hashCode=(new egret.HashObject).hashCode;break;case 3:t.hashCode=++egret.$hashCount;break;default:t={name:"我是对象"}}return t}var i=e.call(this)||this,n=new Dictionary,o=["我是数组"],r=t(1),a="我是字符";n.add(o,o),n.add(r,r),n.add(a,a),n.dump(),i.dispatchSprite=new egret.Sprite,BC.addOnceEvent(i,i.dispatchSprite,egret.Event.ENTER_FRAME,i.onEnterFrameOnce);var s=new egret.Timer(50);return BC.addEvent(i,s,egret.TimerEvent.TIMER,i.onEnterTimer),s.start(),i}return __extends(t,e),t.prototype.onEnterFrame=function(e,t){console.log("我是函数:",t)},t.prototype.onEnterFrameOnce=function(e){var t=this;console.log("我只执行了一次.");for(var i=0;3>i;i++)BC.addEvent(this,this.dispatchSprite,egret.Event.ENTER_FRAME,DelegateUtil.create(this,this.onEnterFrame,i+""));setTimeout(function(){BC.removeEvent(t,t.dispatchSprite,egret.Event.ENTER_FRAME),console.log("3个匿名代理函数被移除事件了."),BC.addEvent(t,t.dispatchSprite,egret.Event.ENTER_FRAME,DelegateUtil.create(t,t.onEnterFrame,"新来的！")),setTimeout(function(){BC.removeEvent(t),console.log("所有该类的监听移除了.")},100)},200)},t.prototype.onEnterTimer=function(e){console.log("我是Timer的事件.")},t}(egret.DisplayObjectContainer);__reflect(Demo.prototype,"Demo");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?n(o):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var weChat;!function(e){var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return null==this._self&&(this._self=new i),this._self},enumerable:!0,configurable:!0}),i.prototype.dispatchChangeEvent=function(t,i){var n=new e.LobbyUIEventConsts(e.LobbyUIEventConsts.DATA_CHANGE),o=new e.EventData;o.iType=t,o.iData=i,n.data=o,this.dispatchEvent(n)},i.prototype.dispatchEventWithData=function(t,i){var n=new e.LobbyUIEventConsts(t);n.data=i,this.dispatchEvent(n)},i._self=null,i}(egret.EventDispatcher);e.weChatMsgCommand=t,__reflect(t.prototype,"weChat.weChatMsgCommand")}(weChat||(weChat={}));var Main=function(e){function t(t){var i=e.call(this)||this;return i.addEventListener(egret.Event.ADDED_TO_STAGE,i.start,i),RES.setMaxLoadingThread(4),egret.ImageLoader.crossOrigin="anonymous",i}return __extends(t,e),t.prototype.onDeActive=function(e){},t.prototype.start=function(e){void 0===e&&(e=null);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter);var i={};i.lobbyMode=!0,i.designWidth=720,i.designHeight=1280,i.scaleMode=egret.StageScaleMode.FIXED_WIDTH,i.debug=!0,uniLib.init(i),uniLib.Global.lobbyMode=!0,uniLib.UIMgr.instance.showLoadingTimeout(TJLoadingUI,"",0),uniLib.UIMgr.instance.commonLoadUI=PublicLoadingView,uniLib.UIMgr.instance.tipsLoadUI=HaoCaiTipLoading,this.loadResConfig(),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){console.error("游戏被暂停了哦"),1==uniLib.Global.isH5&&egret.ticker.pause()},egret.lifecycle.onResume=function(){console.error("游戏被恢复了哦"),1==uniLib.Global.isH5&&egret.ticker.resume()}},t.prototype.loadResConfig=function(){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/weChat.res.json","resource/")},t.prototype.onConfigComplete=function(e){var t=new eui.Theme("resource/weChat.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this)},t.prototype.onThemeLoadComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),uniLib.UIMgr.instance.hideLoading(TJLoadingUI);var t="sz_preload";uniLib.ResLoadMgr.instance.load(t,this.onResourceLoadComplete,this.onResourceLoadError,this,uniLib.GameScene)},t.prototype.onResourceLoadComplete=function(e){this.preLoadEnd()},t.prototype.preLoadEnd=function(){BC.removeEvent(this,egret.MainContext.instance.stage,egret.Event.ACTIVATE,this.onGameActivateHandler),BC.addEvent(this,egret.MainContext.instance.stage,egret.Event.ACTIVATE,this.onGameActivateHandler),uniLib.UIMgr.instance.hideLoading(),this.showLogin()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){weChat.LobbyResUtil.trace("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"sz_preload"==e.groupName&&this.loadingView.onProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.createGameScene=function(){window.weChat=weChat;var e=new weChat.MJLobbyScene;this.addChild(e),console.error("创建游戏场景")},t.prototype.showLogin=function(){var e=RES.getRes("lobbyConfig_json");console.error("showLogin"+e),this.loadRes()},t.prototype.onLogout=function(){console.log("注销游戏进入"+uniLib.Global.gameId+":"+uniLib.Global.getPlatId()),uniLib.SceneMgr.instance.changeScene(weChat.MJLobbyScene)},t.prototype.loadRes=function(){var e=[];e=["sz_assets","sz_table","CommonUI","sz_sound"],1!=uniLib.Global.is_sandbox,weChat.LobbyResUtil.trace("onGameConfigComplete:"+e);var t=RES.getRes("");uniLib.ResLoadMgr.instance.loadGrps(e,this.createGameScene,this.onResourceLoadError,this,PublicLoadingView,!1,null,t)},t.prototype.onResGrpComplete=function(e){this.preLoadEnd()},t.prototype.onGameActivateHandler=function(e){e.type==egret.Event.ACTIVATE,egret.ticker&&egret.ticker.resume()},t.prototype.destory=function(){},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var ArrayUtil=function(){function e(){}return e.mergeArray=function(e,t){},e.removeByValue=function(e,t){if(!(e&&e instanceof Array))return[];for(var i=e.length,n=0;i>n;n++)if(e[n]==t)return e.splice(n,1),e;return e?e:[]},e.removeValue=function(e,t){if(!(e&&e instanceof Array))return[];for(var i=e.length,n=i-1;n>=0;n--)if(e[n]==t||e[n].cardId&&e[n].cardId==t)return e.splice(n,1),e;return e?e:[]},e.isInArray=function(e,t){var i=!1;if(!(t&&t instanceof Array))return i;for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return i},e.numberResolveToArray=function(e,t){for(var i=[],n=0;n<t.length;n++){for(;e>=t[n];)i.push(t[n]),e-=t[n];if(0==e)break}return i},e.deepcopy=function(e){for(var t=[],i=0,n=e.length;n>i;i++)e[i]instanceof Array?t[i]=this.deepcopy(e[i]):t[i]=e[i];return t},e.reverse=function(e){for(var t=[],i=e.length,n=0;i>n;n++)t.unshift(e[n]);return t},e}();__reflect(ArrayUtil.prototype,"ArrayUtil");var weChat;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.init(),t}return __extends(t,e),t.prototype.init=function(){BC.addEvent(this,this,egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin),BC.addEvent(this,this,egret.TouchEvent.TOUCH_END,this.onTouchEnd),BC.addEvent(this,this,egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancel),BC.addEvent(this,this,egret.TouchEvent.TOUCH_MOVE,this.onTouchMove),BC.addEvent(this,this,egret.Event.REMOVED,this.dispose)},t.prototype.onTouchBegin=function(){this.scaleX=1.1,this.scaleY=1.1,RES.hasRes("buttonClick_mp3")&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3")},t.prototype.onTouchEnd=function(){this.scaleX=1,this.scaleY=1},t.prototype.onTouchCancel=function(){this.scaleX=1,this.scaleY=1},t.prototype.onTouchMove=function(){this.scaleX=1,this.scaleY=1},t.prototype.dispose=function(){BC.removeEvent(this)},t}(eui.Button);e.BaseButton=t,__reflect(t.prototype,"weChat.BaseButton")}(weChat||(weChat={}));var weChat;!function(e){var t=function(){function t(){}return t.setCenterX=function(e){e.x=(uniLib.Global.screenWidth-e.width)/2},t.setCenterY=function(e){e.y=(uniLib.Global.screenHeight-e.height)/2},t.addElement=function(e,t){var i=e.some(function(e){return e==t});return i?!0:(e.push(t),!1)},t.operationElement=function(e,t){var i=e.some(function(e){return e==t});return i?e.splice(e.indexOf(t),1):e.push(t),e},t.splitStr=function(e,t,i){var n=new Array;return n=e.split(t),n[i]?n[i]:null},t.getReadyIconPos=function(e,t){var i=t.globalToLocal(e.x,e.y);return i},t.sanzhangNumFormat=function(t){if(!(0>t)){if("number"!==e.TypeUtil.getType(t))return void console.error("wocao,不是个数字，它是个",e.TypeUtil.getType(t));if(1e4>=t)return t+"";var i=0,n="";Math.abs(t)>=1e4&&Math.abs(t)<1e8?(i=1e4,n="万"):(i=1e8,n="亿");var o=""+t/i;o=-1!=o.lastIndexOf(".")?o.substring(0,o.lastIndexOf(".")+4):o.substring(0,o.lastIndexOf(".")+5);var r=o.split(".")[0],a=o.split(".")[1];if(Number(a)){var s=4-r.length>0?4-r.length:0,h=a.split("");h.length=s,a=h.join("");var l=Number("0."+a).toString();l=Boolean(l.split(".")[1])?"."+l.toString().split(".")[1]:"";var c=r+l+n;return c}return r+n}},t.handleString=function(e,t){void 0===t&&(t=6);for(var i,n=e;this.getStrRealLength(n)>t;)i=n.length,n=n.substr(0,i-1);return n},t.getStrRealLength=function(e){var t={GetLength:null};return t.GetLength=function(e){return Number(e.replace(/[\u0391-\uFFE5]/g,"aa").length)},t.GetLength(e)},t.RandomNumBoth=function(e,t){var i=t-e,n=Math.random(),o=e+Math.round(n*i);return o},t.changeTimeToStr=function(e){if(null==e)return"";e=10==e.toString().length?1e3*e:e;var t=new Date;t.setTime(e);var i=t.getFullYear()+"-"+this.getNumStr(t.getMonth()+1)+"-"+this.getNumStr(t.getDate())+"  "+this.getNumStr(t.getHours())+":"+this.getNumStr(t.getMinutes())+":"+this.getNumStr(t.getSeconds());return i},t.getNumStr=function(e){return 10>e?"0"+e:e.toString()},t}();e.GameUtil=t,__reflect(t.prototype,"weChat.GameUtil")}(weChat||(weChat={}));var weChat;!function(e){var t=function(){function e(){}return e.getURLData=function(){if(!this.initParams){this.initParams={};var e=window.location.search;if(""==e)return;if("?"==e.charAt(0)){e=e.slice(1);for(var t,i=e.split(/&/),n=0;n<i.length;n++)t=i[n].split(/=/),2==t.length&&(this.initParams[t[0]]=t[1])}}return this.initParams},e.createBitmapByName=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0);var n=new egret.Bitmap,o=RES.getRes(e);return n.texture=o,n.smoothing=!0,n.x=t,n.y=i,n},e.createTexture=function(e){var t=RES.getRes(e);return t},e.trace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log(e.join(","))},e.randRange=function(e,t){var i=t-e,n=Math.floor(Math.random()*i);return e+n},e.currencyFormat=function(e,t){void 0===t&&(t=-1);var i=Math.abs(e).toString(),n="";0>e&&(n="-");var o="";if(i.indexOf(".")>-1&&(o=i.substring(i.indexOf("."),i.length),i=i.substring(0,i.indexOf("."))),-1!=t)for(;i.length<t;)i="0"+i;for(var r=i.split(""),a=r.length,s=1,h=a-1;h>0;h--,s++)s/3==1&&(s=0,r[h]=","+r[h]);return n+r.join("")+o},e.backToNumber=function(e){var t=/,/g;return e=e.replace(t,""),Math.round(Number(e))},e.getCharLength=function(e){var t=new egret.ByteArray;return t.writeUTF(e),t.position=0,t.bytesAvailable},e.createMovieClip=function(e,t,i){var n,o=RES.getRes(t),r=RES.getRes(i),a=new egret.MovieClipDataFactory(o,r);return n=new egret.MovieClip(a.generateMovieClipData(e)),n.gotoAndStop(1),n.name=e,n},e.createTextFeild=function(e,t,i,n,o,r,a,s){void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=-1),void 0===s&&(s=!1);var h=new egret.TextField;return-1!=a&&(h.width=a),h.fontFamily="微软雅黑",h.bold=s,h.textColor=e,h.textAlign=t,h.text=i,h.size=n,h.x=o,h.y=r,h.multiline=!1,h},e.createFontText=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=-1),o||(o=RES.getRes("betTipText_fnt"));var r=new egret.BitmapText;return-1!=n&&(r.width=n),r.font=o,r.text=e,r.x=t,r.y=i,r},e.createScroll=function(e,t,i,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var r=new egret.ScrollView;return r.width=t,r.height=i,r.x=n,r.y=o,r.setContent(e),r},e.removeFromParent=function(e){e&&e.parent&&e.parent.removeChild(e)},e.removeAllChildren=function(e){for(;e.numChildren>0;)this.removeFromParent(e.getChildAt(0))},e.getTimeStr2=function(){var e=new Date,t=e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+" >>> ";return t},e.numFormat=function(e,t){void 0===t&&(t=0);var i,n="",o="";0>e&&(e=-e,o="-");var r,a;r=[1e9,1e6,1e3],a=["B","M","K"],i=String(e);for(var s=0;s<r.length;s++)if(e>=r[s]){n=a[s],i=-1==t?String(e/r[s]):String(this.setDot(e/r[s],t));break}if(-1!=i.indexOf(".")){for(var h=0;t>h;h++)0==Number(i.charAt(i.length-1))&&(i=h+1==t?i.slice(0,i.length-2):i.slice(0,i.length-1));"."==i.charAt(i.length-1)&&(i=i.slice(0,i.length-1))}return o+i.concat(n)},e.numFormat2=function(e,t){void 0===t&&(t=0);var i,n="",o="";0>e&&(e=-e,o="-");var r,a;r=[1e8,1e4,1e3],a=["亿","万","千"],i=String(e);for(var s=0;s<r.length;s++)if(e>=r[s]){n=a[s],i=-1==t?String(e/r[s]):String(this.setDot(e/r[s],t));break}if(-1!=i.indexOf(".")){for(var h=0;t>h;h++)0==Number(i.charAt(i.length-1))&&(i=h+1==t?i.slice(0,i.length-2):i.slice(0,i.length-1));"."==i.charAt(i.length-1)&&(i=i.slice(0,i.length-1))}return o+i.concat(n)},e.setDot=function(e,t){return void 0===t&&(t=-1),t>0?Math.floor(e*Math.pow(10,t))/Math.pow(10,t):0==t?Math.floor(e):e},e.numberFormat=function(e){var t;return t=1e5>e?""+e:e>=1e5&&1e6>e?(e/1e4).toFixed(2)+"万":e>=1e6&&1e7>e?(e/1e4).toFixed(1)+"万":e>=1e7&&1e8>e?(e/1e4).toFixed(0)+"万":e>=1e8&&1e10>e?(e/1e8).toFixed(2)+"亿":(e/1e8).toFixed(0)+"亿"},e.createMovieClicp=function(e,t){var i=RES.getRes(e+"_json"),n=RES.getRes(e+"_png"),o=new egret.MovieClipDataFactory(i,n),r=new egret.MovieClip(o.generateMovieClipData(t));return r},e}();e.LobbyResUtil=t,__reflect(t.prototype,"weChat.LobbyResUtil")}(weChat||(weChat={}));var ShakeTool=function(){function e(){this.count=0,this.timer=new egret.Timer(1e3)}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.shakeObj=function(e,t,i,n){this.target=e,this.initX=e.x,this.initY=e.y,this.maxDis=n,this.count=t*i,this.rate=i,this.timer.delay=1e3/i,this.timer.repeatCount=this.count,this.timer.addEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this),this.timer.reset(),this.timer.start()},e.prototype.shaking=function(){egret.Tween.removeTweens(this.target),this.target.x=this.initX-this.maxDis+Math.random()*this.maxDis*2,this.target.y=this.initY-this.maxDis+Math.random()*this.maxDis*2,egret.Tween.get(this.target).to({x:this.initX,y:this.initY},999/this.rate)},e.prototype.shakeComplete=function(){this.target&&(egret.Tween.removeTweens(this.target),this.target.x=this.initX,this.target.y=this.initY),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this)},e.prototype.stop=function(){this.shakeComplete()},e}();__reflect(ShakeTool.prototype,"ShakeTool");var weChat;!function(e){var t=function(){function e(){}return e.getType=function(e){var t=Object.prototype.toString,i={undefined:"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object error]":"error","[object Boolean]":"boolean","[object String]":"string","[object Number]":"number"},n=i[typeof e]||i[t.call(e)]||(e?"object":"null");return"number"===n&&(e=+e,e!==e)?"NaN":n},e}();e.TypeUtil=t,__reflect(t.prototype,"weChat.TypeUtil")}(weChat||(weChat={}));var weChat;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.start(),e}return __extends(i,t),i.prototype.start=function(t){void 0===t&&(t=null);var i=new e.LobbyMainGameLayer;this.addChild(i),console.error("LobbyMainGameLayer");var n=new e.MJLobbyMenuVc;n.y=egret.MainContext.instance.stage.stageHeight-1280,egret.MainContext.instance.stage.addChild(n),console.error("menu",n),console.error("---------------menu"),uniLib.UIMgr.instance.hideLoading(PublicLoadingView)},i.prototype.destroy=function(){},i}(egret.DisplayObjectContainer);e.MJLobbyScene=t,__reflect(t.prototype,"weChat.MJLobbyScene")}(weChat||(weChat={}));var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]
})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var weChat;!function(e){var t=function(){function t(){this._pilesNum=0,this.sclaeNum=uniLib.Global.screenHeight/720,this.init()}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.init=function(){this.LobbyPopMap=new Map,this.LobbyTempMap=new Map,this.LobbyPopArray=[],this._popLayer=new e.LobbyPopLayer},t.prototype.destoryPopPanel=function(){this.LobbyPopMap.forEach(function(e,t){e[t]()}),this.LobbyPopMap.clear()},t.prototype.removeOncPanel=function(e){var t=this.LobbyPopMap.get(e);t[e]()},t.prototype.removeOne=function(e,t){var i=this.LobbyPopArray.length;console.error("removeOne-funName",e);for(var n=0;i>n;n++){var o=this.LobbyPopArray[n];if(o.fun==e&&o._this==t){this.LobbyPopArray.splice(n,1);break}if(o.fun==e&&"onMsgClose"==e){this.LobbyPopArray.splice(n,1);break}}},t.prototype.playButtonSound=function(){RES.hasRes("buttonClick_mp3")&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3")},Object.defineProperty(t.prototype,"pilesNum",{get:function(){return this._pilesNum},set:function(t){this._pilesNum=t,e.weChatMsgCommand.instance.dispatchChangeEvent(e.LobbyUIEventConsts.PILES_CHANGE,null)},enumerable:!0,configurable:!0}),t.prototype.testCae=function(t){void 0===t&&(t="(101)test<1>gfrg<2>rggs<3>gr<4>");var i=e.LobbyResUtil.createMovieClicp("sz_Lobby_Loading","loadingMc1");i.x=e.LobbyDataCache.defaultWidth/2-300,i.y=e.LobbyDataCache.defaultHeight/2-150,i.play(-1),egret.MainContext.instance.stage.addChild(i)},t.prototype.showReStartPanel=function(){e.weChatMsgCommand.instance.dispatchChangeEvent(e.LobbyUIEventConsts.SHOW_RESTART_PANEL,null)},t.space=3.1,t}();e.variableCommon=t,__reflect(t.prototype,"weChat.variableCommon")}(weChat||(weChat={}));var uniLib;!function(e){function t(t,i,n,r,a){void 0===r&&(r="fixedWidth"),void 0===a&&(a=!1),t instanceof Object||"function"==typeof i?(t.designWidth&&(o.designWidth=t.designWidth),t.designHeight&&(o.designHeight=t.designHeight),e.ScreenUtils&&e.ScreenUtils.init(t.scaleMode),o.lobbyMode=t.lobbyMode,t.nativeStorage&&(o.nativeStorage=t.nativeStorage),t.reLoginUrl&&(o.reLoginUrl=t.reLoginUrl),t.platId&&(o.platId=t.platId),t.appId?o.appId=t.appId:i&&i.call(n)):(e.ScreenUtils&&e.ScreenUtils.init(r),o.lobbyMode=a),e.ResUtils&&e.ResUtils.init(),e.ZQGameSdk&&e.ZQGameSdk.getCallStatus(o.PhoneCallStatus,o)}function i(e){var t;if("object"==typeof e){for(var n in e)t[n]="object"==typeof e[n]?i(e[n]):e[n];return t}}var n=function(){function e(){this.logLevel=7,this.lobbyMode=!1,this.scaleMode="fixedWidth"}return e}();e.initOptions=n,__reflect(n.prototype,"uniLib.initOptions"),e.init=t,e.cloneObj=i;var o=function(){function t(){}return t.PhoneCallStatus=function(e){"callDisconnected"==e.data.callState},t.Compress=function(e){if(!t.jsonCompress){for(var i=0;i<t.jsonCompress.msglist.length;i++)t.jsonCompress.msglist[i]==e["do"]&&(e["do"]=i+1);return e}return e},t.DeCompress=function(e){for(var i=0;i<t.jsonCompress.msglist.length;i++)i+1==e["do"]&&(e["do"]=t.jsonCompress.msglist[i]);return e},t.DeCompressDefult=function(e){for(var i=0;i<t.jsonCompressDefault.msglist.length;i++)i+1==e["do"]&&(e["do"]=t.jsonCompressDefault.msglist[i]);return e},Object.defineProperty(t,"lobbyMode",{get:function(){return this._lobbyMode},set:function(e){this._lobbyMode=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"resVersion",{get:function(){var t="";if(e.Global.isH5){var i=document.querySelector('meta[name="res-version"]');null!=i&&(t=i.getAttribute("content")),null!=t&&""!=t&&(t="_"+t)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"thmVersion",{get:function(){var t="";if(e.Global.isH5){var i=document.querySelector('meta[name="thm-version"]');null!=i&&(t=i.getAttribute("content")),null!=t&&""!=t&&(t="_"+t)}return t},enumerable:!0,configurable:!0}),t.getPlatId=function(){return 0},t.setPlatInfo=function(t,i,n){e.Utils.setLocalStorage(n+"|"+i+"|platToken",t)},t.setPlatToken=function(i,n,o){t.platId=n,t.gameId=o,e.Utils.setLocalStorage(o+"|"+n+"|platToken",i)},t.openAgent=function(t,i,n,o,r){var a=t+"?code="+i+"&platid="+n+"&gameid="+o;e.ZQGameSdk&&e.ZQGameSdk.openWeb(a,r)},t.isH5=!1,t.isActive=!0,t.debugLevel=0,t.version=161128235600,t.compressMin=0,t.designWidth=1280,t.designHeight=720,t.isRestarting=!1,t.gameId=0,t.lobbyGameId=0,t.is_sandbox=0,t.appId="wx0e52b1eba8f9fb14",t.thirdPlatDir="thirdPlatDir/",t.TextColors={white:16777215,milkWhite:16511407,grayWhite:13547170,yellow:16776960,lightYellow:16765813,orangeYellow:16750848,red:15799040,green:58624,blue:1742039,grayBlue:3101047,purple:15284466,pink:16724016,black:3026221,golden:16766720},t._lobbyMode=!1,t.isInGame=!1,t.reLoginUrl="",t.payPlatId=0,t.bundleId="",t.isCacheToken=!0,t.logUrl="http://server.login.bwgame.com.cn:8020/logger/clientlog",t.gmlevel=0,t.token="",t.platId=0,t.zoneId=0,t}();e.Global=o,__reflect(o.prototype,"uniLib.Global")}(uniLib||(uniLib={}));var uniLib;!function(e){var t=function(){function t(){this._uis=new Object,this._loadings=new Object,this._effects={}}return Object.defineProperty(t,"instance",{get:function(){return null==this._self&&(this._self=new e.UIMgr),this._self},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DefaultLoading",{set:function(e){this.defaultLoadingView=e},enumerable:!0,configurable:!0}),t.removeFastDragonbyContainer=function(e,t,i){},t._self=null,t}();e.DragonUtils=t,__reflect(t.prototype,"uniLib.DragonUtils")}(uniLib||(uniLib={}));var uniLib;!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.curLoadingGrp="",e._autoHide=!0,e._curLoadingId=0,e._currentLoadIndex=0,e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return null==this._self&&(this._self=new i,this._self.initLoadingUI()),this._self},enumerable:!0,configurable:!0}),i.prototype.initLoadingUI=function(){this._loadingMap={},this._thisObj={},this._loadSucc={},this._loadError={}},i.prototype.loadGrps=function(t,n,o,r,a,s,h,l){if(void 0===s&&(s=!0),void 0===h&&(h=!0),""!=this.curLoadingGrp)return void console.warn("资源组 ["+this.curLoadingGrp+"] 正在加载,请等待后台加载完成");var c="merge_"+t.toString();return RES.createGroup(c,t,!0),i.instance.load(c,function(t){e.ResUtils.removeGroup(c),n&&n.call(r,t)},function(t){e.ResUtils.removeGroup(c),o&&o.call(r,t)},r,a,s,h,l),c},i.prototype.load=function(t,i,n,o,r,a,s,h){void 0===a&&(a=!0),void 0===s&&(s=!0),s&&null!=s||(s=!0),r?(this._loadingClass=r,s?e.UIMgr.instance.showProcessBar(r):e.UIMgr.instance.showLoadingTimeout(r)):this._loadingClass=e.UIMgr.instance.commonLoadUI,h&&e.ResUtils.setMustRes(h),i&&(this._loadSucc[t]=i),n&&(this._loadError[t]=n),o&&(this._thisObj[t]=o),this._autoHide=a,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onUniLibResLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onUniLibResLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onUniLibResProgress,this),RES.loadGroup(t)},i.prototype.onUniLibResLoadComplete=function(t){var i=t.groupName;t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onUniLibResLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onUniLibResLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onUniLibResProgress,this)),this._loadingClass&&1==this._autoHide&&e.UIMgr.instance.hideLoading(this._loadingClass),this._loadingClass&&(this._loadingClass=null),this._loadSucc[i]&&this._loadSucc[i].call(this._thisObj[i],t),this.removeLoadDic(i)},i.prototype.onUniLibResLoadError=function(e){var t=e.groupName;console.warn("Group:"+e.groupName+" has failed to load"),e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onUniLibResLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onUniLibResLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onUniLibResProgress,this),this._loadError[t]&&this._loadError[t].call(this._thisObj[t],e),this.removeLoadDic(t))},i.prototype.removeLoadDic=function(e){this._loadError[e]=null,delete this._loadError[e],this._thisObj[e]=null,delete this._thisObj[e],this._loadSucc[e]=null,delete this._loadSucc[e]},i.prototype.onUniLibResProgress=function(t){this._loadingClass&&e.UIMgr.instance.showProcessBar(this._loadingClass,t.itemsLoaded,t.itemsTotal,"",t.groupName)},i.prototype.removeRefrence=function(){this._loadSucc&&(this._loadSucc=null),this._loadingClass&&(this._loadingClass=null),this._loadError&&(this._loadSucc=null),this._thisObj&&(this._thisObj=null)},i._self=null,i}(egret.EventDispatcher);e.ResLoadMgr=t,__reflect(t.prototype,"uniLib.ResLoadMgr")}(uniLib||(uniLib={}));var uniLib;!function(e){var t=function(){function t(){this._currentScene=null,this._lastScene=null}return Object.defineProperty(t,"instance",{get:function(){return null==this._self&&(this._self=new t),this._self},enumerable:!0,configurable:!0}),t.prototype.init=function(e){null==this._currentScene&&(this._currentScene=e)},t.prototype.changeScene=function(t,i,n){var o=this,r=function(e){e.currentTarget.removeEventListener(egret.Event.ADDED_TO_STAGE,r,this),o._lastScene&&(o._lastScene.destroy(),o._lastScene=null)};if(n&&e.Global.isInGame){var a=this._currentScene.currentGame;return null!=a&&(a.parent&&a.parent.removeChild(a),a.destroy()),a=new t(i),(a.width>e.Global.designWidth||a.height>e.Global.designHeight)&&(a.scaleX=e.Global.designWidth/a.width,a.scaleY=e.Global.designHeight/a.height),this._currentScene.currentGame=a,this._currentScene.gameLayer.addChild(a),a}var s=new t(i);return s.width>s.height?s.width>e.Global.designHeight&&s.height>e.Global.designWidth&&(s.scaleX=.8875,s.scaleY=640/720):s.width>e.Global.designWidth&&s.height>e.Global.designHeight&&(s.scaleX=640/720,s.scaleY=.8875),null!=this._currentScene&&(this._lastScene=this._currentScene,e.DisplayUtils.removeFromParent(this._lastScene)),this._currentScene=s,this._currentScene.addEventListener(egret.Event.ADDED_TO_STAGE,r,this),egret.MainContext.instance.stage.addChild(this._currentScene),this._currentScene},Object.defineProperty(t.prototype,"currentScene",{get:function(){return this._currentScene},enumerable:!0,configurable:!0}),t.prototype.lastSceneLeave=function(){null!=this._lastScene&&(this._lastScene.parent&&this._lastScene.parent.removeChild(this._lastScene),this._lastScene.destroy(),this._lastScene=null)},t._self=null,t}();e.SceneMgr=t,__reflect(t.prototype,"uniLib.SceneMgr")}(uniLib||(uniLib={}));var uniLib;!function(e){var t=function(){function e(){this.isStopped=!1,this.isMusic=!1,this.name="",this.position=0,this.egret_channel=null}return e.prototype.stop=function(){this.egret_channel&&(this.position=this.egret_channel.position,this.egret_channel.stop(),this.isStopped=!0,this.egret_channel=null)},e}();__reflect(t.prototype,"MySoundChannel");var i=function(){function i(){this._soundRes={},this._musicVolume=1,this._soundVolume=1,this._musicOpen=!0,this._soundOpen=!0,this._activeSound={},this._activeSoundLoop={},this.loadTimeDic={},this._currentMusicIndex=0,this._currentMusicChanel=null}return Object.defineProperty(i,"instance",{get:function(){return null==this._instance&&(this._instance=new i),this._instance},enumerable:!0,configurable:!0}),i.prototype.playSound=function(e,t,i,n,o){if(void 0===t&&(t=1),this._soundOpen){var r,a=this;if(!this._activeSound[e]||0!=this._activeSound[e].$loops){if(n){var s=function(e,t){t.stop(),a.stopSound(e),n&&n.call(o)};r=this.play(e,t,i,[s],!1)}else r=this.play(e,t,i,[],!1);return null!=r&&(this._activeSound[e]=r),r}}},i.prototype.stopSounds=function(){for(var t in this._activeSound)null!=this._activeSound[t]&&void 0!=this._activeSound[t]&&(this._activeSound[t].stop(),this._activeSound[t]=null,delete this._activeSound[t]);for(var t in this._soundRes)this._soundRes[t]=null,delete this._soundRes[t];e.ResUtils.resetSoundLoadTimes()},i.prototype.stopSound=function(e){null!=this._activeSound[e]&&void 0!=this._activeSound[e]&&(this._activeSound[e].stop(),this._activeSound[e].dispatchEventWith(egret.Event.SOUND_COMPLETE),this._activeSound[e]=null,delete this._activeSound[e])},i.prototype.play=function(t,i,n,o,r){void 0===i&&(i=1),void 0===r&&(r=!0);var a,s=this;o&&o.length>0&&(a=function(e){var i=e.currentTarget;null!=i&&void 0!=i&&(i.removeEventListener(egret.Event.SOUND_COMPLETE,a,s),null!=o&&void 0!=o&&(o.length>1?o[0].call(o[1],t,i):o[0](t,i)))});var h=function(e){if(s._soundRes[t]=e,1==r){var a=!0;if(s._currentMusicChanel&&null!=s.loadTimeDic[s._currentMusicChanel.name]&&null!=s.loadTimeDic[t]&&s.loadTimeDic[s._currentMusicChanel.name]>s.loadTimeDic[t]&&(a=!1),1==a){var h=s.play(t,i,n,o,r);s.resetCurrentMusic(h,t)}}else(new Date).getTime()-s.loadTimeDic[t]<=1e3&&(s.loadTimeDic[t]=0,s._activeSound[t]=s.play(t,i,n,o,r))},l=0;if(null!=this.loadTimeDic[t]&&(l=this.loadTimeDic[t]),this.loadTimeDic[t]=(new Date).getTime(),null==this._soundRes[t]||void 0==this._soundRes[t]){if(RES.hasRes(t)){var c=RES.getRes(t);null!=c||void 0!=c?h(c):(console.log("sound声音资源没有预加载到本地,建议进行预加载:"+t),e.ResUtils.getRes(t,h,null,egret.URLLoaderDataFormat.SOUND))}else e.ResUtils.getRes(t,h,null,egret.URLLoaderDataFormat.SOUND);return null}if(this._soundRes[t]){if(0==r&&(new Date).getTime()-l<30)return this.loadTimeDic[t]=l,null;var u=this._soundRes[t].play(n,i);if(null!=u&&void 0!=u){a&&u.addEventListener(egret.Event.SOUND_COMPLETE,a,s);var d=1==r?this._musicVolume:this._soundVolume;return u.volume=d,u}return null}return null},i.prototype.randomSounds=function(e){e&&(this._bgMusics=e);var t=Math.floor(this._bgMusics.length*Math.random());this.play(this._bgMusics[t],0)},i.prototype.playBgMusic=function(e,t){var i=this;if(i._bgMusics=e,t&&(i._currentMusicIndex=t),i._musicOpen&&i._bgMusics.length>0&&(i._currentMusicIndex>=i._bgMusics.length&&(i._currentMusicIndex=0),null==i._currentMusicChanel||i._bgMusics[i._currentMusicIndex]!=i._currentMusicChanel.name)){var n=i.play(i._bgMusics[i._currentMusicIndex],1,t,[i.onMusicEnd,i]);i.resetCurrentMusic(n,i._bgMusics[i._currentMusicIndex])}},i.prototype.onMusicEnd=function(e){var t=this;if(t._currentMusicIndex++,t._currentMusicIndex==t._bgMusics.length&&(t._currentMusicIndex=0),t._musicOpen&&t._bgMusics.length>0){var i=t.play(t._bgMusics[t._currentMusicIndex],1,0,[t.onMusicEnd,t]);t.resetCurrentMusic(i,t._bgMusics[t._currentMusicIndex])}},i.prototype.resetCurrentMusic=function(e,i){if(null!=e&&void 0!=e){var n=new t;n.name=i,n.isMusic=!0,n.egret_channel=e,n.res=this._soundRes[i],null!=this._currentMusicChanel&&this._currentMusicChanel!=n&&this._currentMusicChanel.name!=n.name&&this.stopBgMusic(),this._currentMusicChanel=n,this._currentMusicChanel.isStopped=!1,this._currentMusicChanel.egret_channel.volume=this._musicVolume}},i.prototype.stopBgMusic=function(){this._currentMusicChanel&&(this._currentMusicChanel.stop(),this.loadTimeDic[this._currentMusicChanel.name]=0,this._currentMusicChanel=null)},i.prototype.pauseBgMusic=function(){this._currentMusicChanel&&this._currentMusicChanel.stop()},i.prototype.resumeBgMusic=function(){if(this._musicOpen&&(!this._currentMusicChanel||this._currentMusicChanel.isStopped)){var e=this,t=0;if(this._currentMusicChanel&&(t=this._currentMusicChanel.position),this._bgMusics&&this._bgMusics.length>0){var i=this.play(this._bgMusics[this._currentMusicIndex],1,t,[e.onMusicEnd,e]);this.resetCurrentMusic(i,this._bgMusics[this._currentMusicIndex])}}},i.prototype.isPlayingBgMusic=function(){return this._currentMusicChanel&&0==this._currentMusicChanel.isStopped?!0:!1},i.prototype.isSoundPlaying=function(e){return this._activeSound[e]&&this._activeSound[e].position?!0:!1},Object.defineProperty(i.prototype,"musicVolume",{get:function(){return this._musicVolume},set:function(e){this._musicVolume=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"soundVolume",{get:function(){return this._soundVolume},set:function(e){this._soundVolume=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"musicOpen",{get:function(){return this._musicOpen},set:function(e){this._musicOpen=e,e?this.resumeBgMusic():this.pauseBgMusic()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"soundOpen",{get:function(){return this._soundOpen},set:function(e){this._soundOpen=e},enumerable:!0,configurable:!0}),i.isFirst=!0,i.SOUND_TOGGLE="sound_toggle",i.MUSIC_TOGGLE="music_toggle",i}();e.SoundMgr=i,__reflect(i.prototype,"uniLib.SoundMgr")}(uniLib||(uniLib={}));var uniLib;!function(e){var t=function(){function t(){this._uis=new Object,this._loadings=new Object,this._effects={}}return Object.defineProperty(t,"instance",{get:function(){return null==this._self&&(this._self=new t),this._self},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DefaultLoading",{set:function(e){this.defaultLoadingView=e},enumerable:!0,configurable:!0}),t.prototype.showUI=function(t,i,n,o,r){void 0===o&&(o=!1),void 0===r&&(r=!1);var a=this,s=egret.getQualifiedClassName(t),h=function(e){a._uis[s]&&a._uis[s].hasEventListener(egret.Event.REMOVED_FROM_STAGE,h,a)&&a._uis[s].removeEventListener(egret.Event.REMOVED_FROM_STAGE,h,a),a._uis[s].destroy&&a._uis[s].destroy(),0==o&&(a._uis[s]=null,delete a._uis[s])};return null==this._uis[s]?this._uis[s]=new t(i):this._uis[s].updateUIData&&this._uis[s].updateUIData(i),this._uis[s]?(0==o&&(this._uis[s].hasEventListener(egret.Event.REMOVED_FROM_STAGE,h,this)||this._uis[s].addEventListener(egret.Event.REMOVED_FROM_STAGE,h,this)),(null==this._uis[s].stage||null==this._uis[s].parent)&&(e.SceneMgr.instance.currentScene&&e.SceneMgr.instance.currentScene.topLayer?e.SceneMgr.instance.currentScene.topLayer.addChild(this._uis[s]):egret.MainContext.instance.stage.addChild(this._uis[s])),this._uis[s]):void 0},Object.defineProperty(t.prototype,"commonLoadUI",{get:function(){return this._commonLoadUI},set:function(e){this._commonLoadUI=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tipsLoadUI",{get:function(){return this._tipsLoadUI},set:function(e){this._tipsLoadUI=e},enumerable:!0,configurable:!0}),t.prototype.showProcessBar=function(e,t,i,n,o,r){return void 0===r&&(r=!1),this.showLoading(e,t,i,n,o,r)},t.prototype.showLoadingTimeout=function(e,t,i,n){void 0===t&&(t=""),void 0===i&&(i=2e4),void 0===n&&(n=""),this.showLoading(e,null,null,n,null,!1,t);var o=this;i&&setTimeout(function(){o.hideLoading(e,t)},i)},t.prototype.showLoading=function(t,i,n,o,r,a,s){void 0===a&&(a=!1),void 0===s&&(s=""),""==s?t&&null!=t?s=egret.getQualifiedClassName(t):(s=egret.getQualifiedClassName(this._commonLoadUI),t=this._commonLoadUI):null==t&&(s=egret.getQualifiedClassName(this._tipsLoadUI),t=this._tipsLoadUI),null==this._loadings[s]&&(this._loadings[s]=new t),this._loadings[s].setProgress&&this._loadings[s].setProgress(2,100),null==this._loadings[s].stage&&(e.SceneMgr.instance.currentScene?e.SceneMgr.instance.currentScene.currentGame&&e.SceneMgr.instance.currentScene.currentGame.parent?e.SceneMgr.instance.currentScene.currentGame.addChild(this._loadings[s]):e.SceneMgr.instance.currentScene.tipsLayer&&e.SceneMgr.instance.currentScene.tipsLayer.addChild(this._loadings[s]):egret.MainContext.instance.stage.addChild(this._loadings[s])),this._loadings[s].setProgress&&this._loadings[s].setProgress(i,n,o,r,a)},t.prototype.showParticle=function(t,i,n,o){var r=function(i){this._effects[t].removeEventListener(egret.Event.COMPLETE,r,this),e.DisplayUtils.removeFromParent(i.target)};try{n&&(this._effects[t].emitterX=n),o&&(this._effects[t].emitterY=o),null==this._effects[t].stage&&(e.SceneMgr.instance.currentScene.effectLayer?e.SceneMgr.instance.currentScene.effectLayer.addChild(this._effects[t]):e.SceneMgr.instance.currentScene.addChild(this._effects[t]),this._effects[t].start(i),this._effects[t].addEventListener(egret.Event.COMPLETE,r,this))}catch(a){console.error("找不到粒子效果")}return this._effects[t]||null},t.prototype.hideLoading=function(t,i,n){void 0===i&&(i=""),void 0===n&&(n=!0),""==i&&(t&&null!=t?i=egret.getQualifiedClassName(t):(i=egret.getQualifiedClassName(this._commonLoadUI),t=this._commonLoadUI)),null!=this._loadings[i]&&(this._loadings[i].setProgress&&this._loadings[i].setProgress(2,100),e.DisplayUtils.removeFromParent(this._loadings[i]),n&&(this._loadings[i]=null,delete this._loadings[i]))},t.prototype.hideUI=function(t,i){void 0===i&&(i=!0);var n=egret.getQualifiedClassName(t);e.DisplayUtils.removeFromParent(this._uis[n]),i&&(this._uis[n]=null,delete this._uis[n])},t.prototype.destroyUI=function(t){var i=egret.getQualifiedClassName(t);null!=this._uis[i]&&void 0!=this._uis[i]&&(e.DisplayUtils.removeFromParent(this._uis[i]),delete this._uis[i])},t.prototype.clearOldSceneUis=function(){if(this._uis)for(var e in this._uis){var t=this._uis[e];t&&null==t.parent&&delete this._uis[e]}if(this._loadings)for(var e in this._loadings){var t=this._loadings[e];t&&null==t.parent&&delete this._loadings[e]}},t._self=null,t}();e.UIMgr=t,__reflect(t.prototype,"uniLib.UIMgr")}(uniLib||(uniLib={}));var uniLib;!function(e){function t(e){if(!e)return null;var t=a[e];if(t)return t;var i=e.split("."),n=i.length;t=__uglobal;for(var o=0;n>o;o++){var r=i[o];if(t=t[r],!t)return null}return a[e]=t,t}function i(e){var t="^"+e+".";for(var i in a)i.match(t)&&console.error("匹配成功:"+i)}function n(e){if(!e)return null;var t="^"+e+".";if(-1==e.indexOf("."))for(var i in a)i.match(t)&&(a[i]=null,delete a[i]);else a[e]=null,delete a[e]}function o(e){if(!e||"object"!=typeof e&&!e.prototype)return null;var t=e.prototype?e.prototype:Object.getPrototypeOf(e),i=Object.getPrototypeOf(t);if(!i)return null;var n=r(i.constructor);return n?n:null}function r(e){var t=typeof e;if(!e||"object"!=t&&!e.prototype)return t;var i=e.prototype?e.prototype:Object.getPrototypeOf(e);if(i.hasOwnProperty("__class__"))return i.__class__;var n=i.constructor.toString().trim(),o=n.indexOf("("),r=n.substring(9,o);return Object.defineProperty(i,"__class__",{value:r,enumerable:!1,writable:!0}),r}var a={};e.getDefinitionByName=t,e.test=i,e.delDefinitionByName=n,e.getQualifiedSuperclassName=o,e.getQualifiedClassName=r}(uniLib||(uniLib={}));var __uglobal=__uglobal||this,uniLib;!function(e){var t=function(){function t(){}return t.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t.createMovieClicp=function(e,t){var i=RES.getRes(e+"_json"),n=RES.getRes(e+"_png"),o=new egret.MovieClipDataFactory(i,n),r=new egret.MovieClip(o.generateMovieClipData(t));return r},t.createMask=function(t,i,n,o){void 0===t&&(t=.3),void 0===o&&(o=0);var r=new egret.Sprite;return r.graphics.clear(),r.graphics.beginFill(o,t),r.graphics.drawRect(0,0,i?i:e.Global.screenWidth,n?n:e.Global.screenHeight),r.graphics.endFill(),r},t.createShape=function(t,i,n,o){void 0===t&&(t=.3),void 0===o&&(o=0);var r=new egret.Shape;return r.graphics.clear(),r.graphics.beginFill(o,t),r.graphics.drawRect(0,0,i?i:e.Global.screenWidth,n?n:e.Global.screenHeight),r.graphics.endFill(),r},t.createCircle=function(e,t,i){void 0===e&&(e=.3),void 0===i&&(i=0);var n=new egret.Sprite;return n.graphics.clear(),n.graphics.beginFill(i,e),n.graphics.drawCircle(0,0,t),n.graphics.endFill(),n},t.createDragonBonesDisplay=function(e,t,i,n,o){var r=RES.getRes(e);if(i&&null!=i)var a=RES.getRes(t),s=RES.getRes(i);else var a=RES.getRes(t+"_json"),s=RES.getRes(t+"_png");(null==n||0==n.length)&&(n="armature");var h;if(dragonBones){var l=new dragonBones.EgretFactory;l.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(r)),l.addTextureAtlas(new dragonBones.EgretTextureAtlas(s,a)),o?(h=l.buildFastArmature(n),h.enableAnimationCache(o)):h=l.buildArmature(n)}return h},t.runDragonBonesArmature=function(e,t,i,n){return void 0===n&&(n=!0),null==e?void console.error("armature不能为空"):(dragonBones.WorldClock.clock.add(e),void(n?e.animation.gotoAndPlay(t,0,-1,i,0):e.animation.gotoAndStop(t,0)))},t.destoryDragonBonesArmature=function(e,t){return null==e?void console.error("armature不能为空"):(dragonBones.WorldClock.clock.remove(e),e.animation.stop(),void e.dispose())},t.createTextLabel=function(e,t,i,n,o,r,a,s,h,l,c,u){void 0===e&&(e=0),void 0===t&&(t="left"),void 0===i&&(i="none"),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===h&&(h=0),void 0===l&&(l=0),void 0===c&&(c=0),void 0===u&&(u=0);var d=new egret.TextField;return d.textColor=e,d.textAlign=t,d.fontFamily="微软雅黑",d.text=i,d.size=n,0!=o&&(d.width=o),0!=r&&(d.height=r),0!=a&&a!=s&&(d.strokeColor=a,d.stroke=s),d.rotation=c,0!=u&&(d.skewX=u),d.x=h,d.y=l,d},t.removeFromParent=function(e){e&&e.parent&&e.parent.removeChild(e)},t.removeAllChildren=function(e){for(;e&&e.numChildren&&e.numChildren>0;)this.removeFromParent(e.getChildAt(0))},t.catchScreen=function(e,t){var i=new egret.RenderTexture;return i.drawToTexture(e),i.toDataURL("image/png",t?t:new egret.Rectangle(0,0,e.width,e.height))},t.catchScreenToTex=function(e,t,i){var n=new egret.RenderTexture;return n.drawToTexture(e,t,i),n},t.lightArea=function(t,i){void 0===i&&(i=.8);var n=new egret.DisplayObjectContainer,o=e.DisplayUtils.createShape(i,e.Global.screenWidth,e.Global.screenHeight);n.addChild(o),n.addChild(t),t.blendMode=egret.BlendMode.ERASE;var r=new egret.RenderTexture;r.drawToTexture(n);var a=new egret.Bitmap;return a.texture=r,a},t.ticketStarted=!1,t}();e.DisplayUtils=t,__reflect(t.prototype,"uniLib.DisplayUtils")}(uniLib||(uniLib={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var uniLib;!function(e){var t=function(e){function t(t){var i=e.call(this)||this;return i.uiLayer=new egret.DisplayObjectContainer,i.topLayer=new egret.DisplayObjectContainer,i.effectLayer=new egret.DisplayObjectContainer,i.mainUILayer=new egret.DisplayObjectContainer,i.maskLayer=new egret.DisplayObjectContainer,i.tipsLayer=new egret.DisplayObjectContainer,i.initBaseLayers(),i.addEventListener(egret.Event.ADDED_TO_STAGE,i.start,i),i}return __extends(t,e),t.prototype.initBaseLayers=function(){this.addChild(this.uiLayer),this.addChild(this.effectLayer),this.addChild(this.topLayer),this.addChild(this.mainUILayer),this.addChild(this.maskLayer),this.addChild(this.tipsLayer),this.awake()},t.prototype.awake=function(){},t.prototype.start=function(e){void 0===e&&(e=null)},t.prototype.resize=function(){},t.prototype.destroy=function(){},t}(egret.DisplayObjectContainer);e.GameScene=t,__reflect(t.prototype,"uniLib.GameScene",["uniLib.IScene"])}(uniLib||(uniLib={}));var uniLib;!function(e){var t=function(t){function i(i){var n=t.call(this)||this;return n.uiLayer=new egret.DisplayObjectContainer,n.topLayer=new egret.DisplayObjectContainer,n.effectLayer=new egret.DisplayObjectContainer,n.mainUILayer=new egret.DisplayObjectContainer,n.maskLayer=new egret.DisplayObjectContainer,n.tipsLayer=new egret.DisplayObjectContainer,n.gameLayer=new egret.DisplayObjectContainer,e.SceneMgr.instance.init(n),n.initBaseLayers(),n.addEventListener(egret.Event.ADDED_TO_STAGE,n.start,n),n}return __extends(i,t),i.prototype.initBaseLayers=function(){this.addChild(this.uiLayer),this.addChild(this.topLayer),this.addChild(this.effectLayer),this.addChild(this.mainUILayer),this.addChild(this.maskLayer),this.addChild(this.tipsLayer),this.awake()},i.prototype.awake=function(){},i.prototype.start=function(e){void 0===e&&(e=null)},i.prototype.resize=function(){},i.prototype.destroy=function(){},i.prototype.addGame=function(t){this.currentGame=t,null==this._bgMask&&(this._bgMask=new egret.Sprite,this._bgMask.graphics.clear(),this._bgMask.graphics.beginFill(0,0),this._bgMask.graphics.drawRect(0,0,e.Global.screenWidth,e.Global.screenHeight),this._bgMask.graphics.endFill(),this._bgMask.width=e.Global.screenWidth,this._bgMask.height=e.Global.screenHeight,this._bgMask.touchEnabled=!0,this._bgMask.visible=!0),this.gameLayer.addChild(this._bgMask),this.gameLayer.addChild(t),this.addChildAt(this.gameLayer,1)},i.prototype.removeGame=function(t){void 0===t&&(t=null);var i=e.SceneMgr.instance.currentScene.currentGame;i&&(i.parent&&i.parent.removeChild(i),i.destroy(),i=null),e.DisplayUtils.removeFromParent(this.gameLayer),this.gameLayer.removeChildren(),this.currentGame=null},i}(egret.DisplayObjectContainer);e.LobbyScene=t,__reflect(t.prototype,"uniLib.LobbyScene",["uniLib.IScene"])}(uniLib||(uniLib={}));var uniLib;!function(e){var t=function(){function e(){}return e.resetSoundLoadTimes=function(){for(var e in this._resRequestSoundLoadTimes)this._resRequestSoundLoadTimes[e]=null,delete this._resRequestSoundLoadTimes[e]},e.setMustRes=function(e){try{this._mustResList=[];for(var t in e){var i=e[t];i&&i.resName&&-1==this._mustResList.indexOf(i.resName)&&this._mustResList.push(i.resName)}}catch(n){console.warn("setMustRes:必须资源列表出错,请检查必须资源列表格式")}},e.removeGroup=function(t){var i=e.getGroupDic();i&&(i[t]?(i[t]=null,delete i[t]):i[t]&&(i[t]=null,delete i[t]))},e.init=function(){0==this.inited&&(this.inited=!0,RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),"undefined"!=typeof dragonBones&&egret.startTick(this.onDragonBonesTick,egret.MainContext.instance.stage))},e.onDragonBonesTick=function(e){return"undefined"==typeof dragonBones?!1:(dragonBones.WorldClock.clock.advanceTime(-1),!0)},e.onItemLoadError=function(e){this._mustResList.indexOf(e.resItem.name)>=0},e.getRes=function(e,t,i,n){function o(n){if(s._needLoadDicCallBack[e]){for(;s._needLoadDicCallBack[e].length>0;){var r=s._needLoadDicCallBack[e].shift();r[0].call(r[1],n,e)}delete s._needLoadDicCallBack[e]}else null!=i?t.call(i,n,e):t&&t(n,e);if(-1!=s._loadingDic.indexOf(e)&&(s._asynLoadLevel--,s._loadingDic.splice(s._loadingDic.indexOf(e),1)),s._needloadDic.length>0&&this._asynLoadLevel<this.MAX_LOAD_LEVEL){var a=s._needloadDic.shift();s.getRes(a,o,s)}}function r(i){s._resRequestSoundLoadTimes[e]=0;var n=i.target;n.removeEventListener(egret.Event.COMPLETE,r,s),n.removeEventListener(egret.IOErrorEvent.IO_ERROR,a,s);var o=n.data;t&&t(o,e)}function a(t){var i=t.target;if(i.removeEventListener(egret.Event.COMPLETE,r,s),i.removeEventListener(egret.IOErrorEvent.IO_ERROR,a,s),console.error("加载资源失败："+e),null!=s._resRequestSoundLoadTimes[e]&&s._resRequestSoundLoadTimes[e]>0){s._resRequestSoundLoadTimes[e]--;var n=new egret.URLLoader;n.dataFormat=egret.URLLoaderDataFormat.SOUND}}var s=this;if(n==egret.URLLoaderDataFormat.SOUND){if(null!=this._resRequestSoundLoadTimes[e])return 0==this._resRequestSoundLoadTimes[e]?void 0:void this._resRequestSoundLoadTimes[e]++;this._resRequestSoundLoadTimes[e]=1;var h=new egret.URLLoader;h.dataFormat=egret.URLLoaderDataFormat.SOUND,h.once(egret.Event.COMPLETE,r,s),h.once(egret.IOErrorEvent.IO_ERROR,a,s);RES.configInstance;console.error("找不到将要加载的资源："+e+"	")}else if(RES.hasRes(e)){var l=RES.getRes(e);if(l)o(l);else{if(this._loadingDic.indexOf(e)>=0){var c=[t,i];return null==this._needLoadDicCallBack[e]&&(this._needLoadDicCallBack[e]=[]),void this._needLoadDicCallBack[e].push(c)}if(this._asynLoadLevel<this.MAX_LOAD_LEVEL)this._loadingDic.push(e),this._asynLoadLevel++,RES.getResAsync(e,o,this);else{var c=[t,i];-1==this._needloadDic.indexOf(e)&&this._needloadDic.push(e),null==this._needLoadDicCallBack[e]&&(this._needLoadDicCallBack[e]=[]),this._needLoadDicCallBack[e].push(c)}}}else RES.getResByUrl(e,o,this)},e.clearResConfigByConfigName=function(e){var t=RES.configInstance;for(var i in t.groupDic){var n=t.groupDic[i];for(var o in n)e.indexOf(o)>=0&&t.keyMap[n[o].name]&&(n[o].name=null,delete n[o].name);t.groupDic[i]=null,delete t.groupDic[i]}},e.clearResConfigByGroupName=function(e){},e.getBmp=function(e,t,i,n){void 0===n&&(n=!0);
var o;return o},e.freeBmp=function(e,t){},e.getMovieClip=function(e,t,i,n,o){function r(o,r){if(a++,a==s.length){var h=new egret.MovieClipDataFactory(RES.getRes(e+"_json"),RES.getRes(e+"_png")),l=new egret.MovieClip(h.generateMovieClipData(t));return void i.call(n,l)}}void 0===o&&(o=!1);var a=0;null==t&&(t="");var s=[e+"_json",e+"_png"];for(var h in s)this.getRes(s[h],r,this)},e.freeMovieClip=function(e,t,i){},e.loadResConfig=function(e){},e.loadGameGroupReses=function(e,t,n,o,r,a){void 0===a&&(a="resource/");var s=function(a){a.groupName==e&&(this.loadedConfig[e].status=i.LOADED,RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,s,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,n,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,o,this),t.call(r,a))},h=function(t){t.groupName==e&&n&&n.call(r,t)},l=function(t){t.groupName==e&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,s,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,n,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,o,this),o&&o.call(r,t))},c=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,c,this);var i=[];for(var n in t.target.resConfig.groupDic)i.push(n);RES.createGroup(e,i),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,s,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,h,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,l,this),RES.loadGroup(e)};null==this.loadedConfig[e]?(this.loadedConfig[e]={},this.loadedConfig[e].status=i.LOADDING,RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,c,this),RES.loadConfig(e,a)):this.loadedConfig[e].status==i.LOADED&&t.call(r)},e.MAX_LOAD_LEVEL=1,e._asynLoadLevel=0,e._loadingDic=[],e._needloadDic=[],e._needLoadDicCallBack={},e._resRequestSoundLoadTimes={},e._mustResList=[],e.getGroupDic=function(e){var t,i=RES.configInstance;return i&&(i.groupDic&&i.groupDic?t=e?i.groupDic[e]:i.groupDic:i.config&&i.config.groups&&(t=e?i.config.groups[e]:i.config.groups)),t},e.inited=!1,e.loadedConfig={},e}();e.ResUtils=t,__reflect(t.prototype,"uniLib.ResUtils");var i;!function(e){e[e.LOADDING=0]="LOADDING",e[e.LOADED=1]="LOADED"}(i=e.GROUP_LOAD_STATUS||(e.GROUP_LOAD_STATUS={}))}(uniLib||(uniLib={}));var weChat;!function(e){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.destory=function(){t.prototype.destory.call(this),this._checkIcon=null,this._label=null,this._txtbg=null},i.prototype.initUI=function(){this._checkType=0,this._assetsArr=["mjl_create_checkbg","mjl_create_check"],this._checkBg=e.LobbyResUtil.createBitmapByName("mjl_create_checkbg"),this.addChild(this._checkBg),this._checkIcon=e.LobbyResUtil.createBitmapByName("mjl_create_check",0,0),this.addChild(this._checkIcon),this.check=!1,this._label=e.LobbyResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,"",34,60,10),this._label.height=40,this.addChild(this._label)},Object.defineProperty(i.prototype,"checkType",{get:function(){return this._checkType},enumerable:!0,configurable:!0}),i.prototype.setCheckType=function(t){if(this._checkType!=t){switch(this._checkType=t,t){case 1:this._assetsArr=["mjl_create_checkbg","mjl_create_check","mjl_create_checkdisable"];break;case 2:this._assetsArr=["mjl_multiple_bg","mjl_multiple_check","mjl_multiple_disable"],this._checkIcon.y=-8,this._checkBg.y=-8;break;case 3:this._checkIcon.y=-8,this._checkBg.y=-8,this._assetsArr=["mjl_sub-multiple_bg","mjl_sub-multiple_check","mjl_sub-multiple_disable"];break;case 4:this._checkIcon.y=1,this._checkBg.y=0,this._assetsArr=["mjl_checkbg_small","mjl_check_small","mjl_checkbg_smalldisable"]}this._checkBg.texture=e.LobbyResUtil.createTexture(this._assetsArr[0]),this._checkIcon.texture=e.LobbyResUtil.createTexture(this._assetsArr[1])}},i.prototype.setLabelSize=function(e){this._label.size=e},Object.defineProperty(i.prototype,"label",{set:function(e){this._label.text=e,this._txtbg||(this._txtbg=new egret.Sprite,this.addChild(this._txtbg)),this._txtbg.graphics.clear(),this._txtbg.graphics.beginFill(16711680,0),this._txtbg.graphics.drawRect(this._label.x-5,this._label.y-5,this._label.textWidth+10,this._label.textHeight+10),this._txtbg.graphics.endFill()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"htmlLabel",{set:function(e){this._label.textFlow=(new egret.HtmlTextParser).parser(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"check",{get:function(){return this._checkIcon.visible},set:function(e){this._checkIcon.visible=e},enumerable:!0,configurable:!0}),i.prototype.setEnable=function(t){this._checkIcon.visible=!1,this._assetsArr[2]&&(t?(this._label.textColor=3751724,this._checkBg.texture=e.LobbyResUtil.createTexture(this._assetsArr[0])):(this._label.textColor=11248274,this._checkBg.texture=e.LobbyResUtil.createTexture(this._assetsArr[2]))),this.touchEnabled=t,this.touchChildren=t},Object.defineProperty(i.prototype,"checkWidth",{get:function(){return this._label.x+this._label.width+5},enumerable:!0,configurable:!0}),i}(e.LobbyBaseVc);e.CreateCheckMc=t,__reflect(t.prototype,"weChat.CreateCheckMc")}(weChat||(weChat={}));var weChat;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.initUI(),e}return __extends(i,t),i.prototype.initUI=function(){this._loadingImg=e.LobbyResUtil.createBitmapByName("mjl_dataLoading"),this._loadingImg.x=-this._loadingImg.width/2,this._loadingImg.y=-this._loadingImg.height/2,this.addChild(this._loadingImg)},i.prototype.play=function(){this.stopTimer(),this._timer=new egret.Timer(50,0),this._timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer.start()},i.prototype.destory=function(){e.LobbyResUtil.removeAllChildren(this),e.LobbyResUtil.removeFromParent(this),this.stopTimer(),this._loadingImg=null},i.prototype.stopTimer=function(){this._timer&&(this._timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer.stop(),this._timer=null)},i.prototype.onTimer=function(e){this.rotation=this.rotation-10},i}(egret.DisplayObjectContainer);e.DataLoading=t,__reflect(t.prototype,"weChat.DataLoading")}(weChat||(weChat={}));var weChat;!function(e){var t=function(t){function i(e,i,n){void 0===i&&(i=null),void 0===n&&(n=!0);var o=t.call(this)||this;return o.srcArr=e,o._label=i,o._autoDestory=n,o.initUI(),o.addEventListener(egret.Event.REMOVED_FROM_STAGE,o.onRemove,o),o}return __extends(i,t),i.prototype.addAdjective=function(t,i,n){this._adjective||(this._adjective=e.LobbyResUtil.createBitmapByName(t),this.addChild(this._adjective),this._adjective.x=i,this._adjective.y=n)},i.prototype.onRemove=function(e){this._autoDestory&&this.destory()},i.prototype.initUI=function(){var t;t=this.srcArr[0],this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this._icon?this._icon.texture=e.LobbyResUtil.createTexture(t):(this._icon=e.LobbyResUtil.createBitmapByName(t),this._icon.name="icon",this.addChild(this._icon)),this._label&&(this._labelTxt=e.LobbyResUtil.createTextFeild(16777215,egret.HorizontalAlign.CENTER,this._label,20,0,10,this._icon.width),this.addChild(this._labelTxt)),this.anchorOffsetX=this._icon.width/2,this.anchorOffsetY=this._icon.height/2},i.prototype.redPoint=function(t,i,n,o,r){void 0===i&&(i=0),void 0===n&&(n=0),RES.hasRes(t)&&(this._redPoint||(this._redPoint=e.LobbyResUtil.createBitmapByName(t),this.addChild(this._redPoint)),this._redPoint.x=this._icon.width-this._redPoint.width+i,this._redPoint.y=this.height-this._icon.height+n,this._redPoint.touchEnabled=!1)},i.prototype.removeRedPoint=function(){this._redPoint&&(e.LobbyResUtil.removeFromParent(this._redPoint),this._redPoint=null)},i.prototype.onTouchBegin=function(t){RES.hasRes(this.srcArr[1])&&(this._icon.texture=e.LobbyResUtil.createTexture(this.srcArr[1])),this.scaleX=1.1,this.scaleY=1.1,RES.hasRes("buttonClick_mp3")&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this)},i.prototype.onTouchEnd=function(t){this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),RES.hasRes(this.srcArr[1])&&(this._icon.texture=e.LobbyResUtil.createTexture(this.srcArr[0])),this.scaleX=1,this.scaleY=1},i.prototype.addClickArea=function(e){this._area||(this._area=new egret.Sprite,this._area.touchEnabled=!0,this.addChild(this._area)),this._area.graphics.clear(),this._area.graphics.beginFill(16711680,0),this._area.graphics.drawRect(-e,-e,this._icon.width+2*e,this._icon.height+2*e),this._area.graphics.endFill()},i.prototype.destory=function(){this.touchEnabled=!1,this.stage&&(this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this)),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),e.LobbyResUtil.removeFromParent(this),e.LobbyResUtil.removeAllChildren(this),this._area=null,this._icon=null,this._label=null,this._labelTxt=null,this._redPoint=null},i}(egret.Sprite);e.LobbyGameButton=t,__reflect(t.prototype,"weChat.LobbyGameButton")}(weChat||(weChat={}));var LoadSecondPanel=function(e){function t(){var t=e.call(this)||this;return t.init(),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStageHandler,t),t}return __extends(t,e),t.prototype.init=function(){weChat.LobbyResUtil.removeAllChildren(this);var e=new eui.Rect(weChat.LobbyDataCache.defaultWidth,weChat.LobbyDataCache.defaultHeight,0);e.alpha=.45,this.addChildAt(e,0),RES.hasRes("mjl_loading_drag_json")&&(this._armature=uniLib.DisplayUtils.createDragonBonesDisplay("mjl_loading_drag_json","mjl_loading_json","mjl_loading_png","MovieClip"),dragonBones.WorldClock.clock.add(this._armature),egret.Ticker.getInstance().register(function(e){dragonBones.WorldClock.clock.advanceTime(-1)},this),this._armature.display.x=Math.round(weChat.LobbyDataCache.defaultWidth/2),this._armature.display.y=Math.round(weChat.LobbyDataCache.defaultHeight/2-15),this.addChild(this._armature.display))},t.prototype.onAddToStageHandler=function(e){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStageHandler,this),this._armature?this._armature.animation.play():this.init()},t.prototype.onRemoveFromStageHandler=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStageHandler,this),this._armature&&(this._armature.animation.stop(),dragonBones.WorldClock.clock.remove(this._armature),this._armature=null,egret.Ticker.getInstance().unregister(function(e){dragonBones.WorldClock.clock.advanceTime(-1)},this)),weChat.LobbyResUtil.removeAllChildren(this),weChat.LobbyResUtil.removeFromParent(this)},t.prototype.setProgress=function(){},t}(egret.Sprite);__reflect(LoadSecondPanel.prototype,"LoadSecondPanel");var weChat;!function(e){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.initUI=function(){var t="sz_Toast_png";t=RES.getRes("sz_Toast_png")?"sz_Toast_png":"mjl_tipsBg",this._bg=e.LobbyResUtil.createBitmapByName(t),this.addChild(this._bg),this._bg.scale9Grid=new egret.Rectangle(332,36,194,49),this._text=e.LobbyResUtil.createTextFeild(16777215,egret.HorizontalAlign.CENTER,"",32,128,10,686),this._text.lineSpacing=7,this._text.multiline=!0,this.addChild(this._text)},i.prototype.setText=function(t){if(t){this._text.text=t;var i=t;this._text.textFlow=(new egret.HtmlTextParser).parser(decodeURIComponent(i)),this._text.textWidth+22>=this._text.width&&(this._text.textAlign=egret.HorizontalAlign.LEFT);[{name:"this.chat_lb.measuredHeight",fileExtension:this._text.measuredHeight},{name:"this._text.textheight",fileExtension:this._text.textHeight},{name:"this._text.Height",fileExtension:this._text.height},{name:"this._text.textWidth",fileExtension:this._text.textWidth},{name:"this._text.Width",fileExtension:this._text.width},{name:"this._text.x",fileExtension:this._text.x},{name:"this._text.size",fileExtension:this._text.height},{name:"this._text.y",fileExtension:this._text.y}];this._bg.height=4*this._text.textHeight,this._text.y=Math.floor(this._bg.height/2)-.26*this._bg.height,this.x=Math.round((e.LobbyDataCache.defaultWidth-this.width)/2),this.y=Math.round((e.LobbyDataCache.defaultHeight-this.height)/2),this.showDelay()}},i.prototype.showDelay=function(){egret.Tween.get(this).wait(2e3).to({alpha:0},2e3,egret.Ease.circOut).call(this.destory,this)},i.prototype.destory=function(){e.LobbyResUtil.removeAllChildren(this),e.LobbyResUtil.removeFromParent(this),this._bg=null,this._text=null},i}(e.LobbyBaseVc);e.LobbyMildAlertVC=t,__reflect(t.prototype,"weChat.LobbyMildAlertVC")}(weChat||(weChat={}));var weChat;!function(e){var t=function(t){function i(e){var i=t.call(this)||this;return i.touchEnabled=!0,i._needClose=e,i.initUI(),i}return __extends(i,t),i.prototype.initUI=function(){console.error("确定面板确定面板");var t=e.LobbyResUtil.createBitmapByName("sz_Lobby_UserInfo_Nickname_Bg");if(t.scale9Grid=new egret.Rectangle(180,60,90,60),t.width=665,t.height=371,this.addChild(t),this.title=e.LobbyResUtil.createTextFeild(4079177,egret.HorizontalAlign.CENTER,"",32,140,18,191),this.info=e.LobbyResUtil.createTextFeild(16777215,egret.HorizontalAlign.CENTER,"",28,40,59,588),this.info.lineSpacing=15,this.addChild(this.info),this.addChild(this.title),this._needClose){var i=new e.LobbyGameButton(["sz_Lobby_help_close","sz_Lobby_help_close"]);i.x=t.width-26,i.y=20,i.addClickArea(20),i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMsgClose,this),this.addChild(i)}e.variableCommon.getInstance().LobbyPopArray.push({_this:this,fun:"onMsgClose"})},i.prototype.onMsgClose=function(){egret.Tween.removeTweens(this),egret.Tween.get(this).to({alpha:0},200).call(this.removeTarget,this,[this])},i.prototype.removeTarget=function(){e.LobbyPopupManager.removePopUp("onMsgClose",this),this.dispatchEventWith(e.LobbyUIEventConsts.CLOSE),this.destory()},i.prototype.setData=function(t,i,n,o,r,a,s,h){if(void 0===n&&(n=null),void 0===o&&(o=null),void 0===r&&(r=null),void 0===a&&(a=0),void 0===s&&(s=28),void 0===h&&(h=egret.HorizontalAlign.CENTER),this._backFn=o,this._backObj=r,this.info.size=s,this.title.text=t,this.info.text=i,this.info.textAlign=h,this.info.y=40+Math.round((254-this.info.textHeight)/2),1==n.length){if(n[0]&&"确定"!=n[0]&&""!=n[0]||(n[0]="sz_Lobby_ComBtn1"),this.yesBtn=new e.LobbyGameButton([n[0],n[0]]),this.yesBtn.x=Math.round((this.width-this.yesBtn.width)/2)+this.yesBtn.width/2,this.yesBtn.y=this.height-165+this.yesBtn.height/2,"sz_Lobby_ComBtn1"==n[0]){var l=e.LobbyResUtil.createBitmapByName("sz_common_sure_png",50,17);this.yesBtn.addChild(l)}this.addChild(this.yesBtn)}else if(2==n.length){if(n[0]&&""!=n[0]||(n[0]="确定"),n[1]&&""!=n[1]||(n[1]="取消"),this.yesBtn=new e.LobbyGameButton(["sz_Lobby_ComBtn1","sz_Lobby_ComBtn2"]),this.yesBtn.x=317.5-this.yesBtn.width-10+this.yesBtn.width/2,this.yesBtn.y=260+this.yesBtn.height/2,"确定"==n[0]){var l=e.LobbyResUtil.createBitmapByName("sz_common_sure_png",50,17);this.yesBtn.addChild(l)}if(this.addChild(this.yesBtn),this.noBtn=new e.LobbyGameButton(["sz_Lobby_ComBtn1","sz_Lobby_ComBtn2"]),this.noBtn.x=327.5+this.noBtn.width/2,this.noBtn.y=260+this.noBtn.height/2,"取消"==n[1]){var c=e.LobbyResUtil.createBitmapByName("sz_common_cancel_png",50,17);this.noBtn.addChild(c)}this.addChild(this.noBtn)}this._backFn&&this._backFn[0]&&this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[0],this._backObj),this._backFn&&this._backFn[1]&&this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[1],this._backObj),this.yesBtn&&this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMsgClose,this),this.noBtn&&this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMsgClose,this),this.title.x=(635-this.title.width)/2},Object.defineProperty(i.prototype,"titleY",{set:function(e){this.title.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"titleColor",{set:function(e){this.title.textColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"msgColor",{set:function(e){this.info.textColor=e},enumerable:!0,configurable:!0}),i.prototype.destory=function(){this.yesBtn&&(this._backFn&&this._backFn[0]&&this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[0],this._backObj),this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMsgClose,this),this.yesBtn=null),this.noBtn&&(this.noBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMsgClose,this),this._backFn&&this._backFn[1]&&this.noBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[1],this._backObj),this.noBtn=null),this.title=null,this.info=null,this._backFn=null,this._backObj=null,e.LobbyResUtil.removeFromParent(this),e.LobbyResUtil.removeAllChildren(this)},i}(egret.Sprite);e.LobbyMsgBox=t,__reflect(t.prototype,"weChat.LobbyMsgBox")}(weChat||(weChat={}));var PublicLoadingView=function(e){function t(){var t=e.call(this)||this;return t.pointNum=[1,2,4,5,7,8,10,11,13,15,15],t.init(),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemove,t),t}return __extends(t,e),t.prototype.onRemove=function(e){console.error("公共加载")},t.prototype.init=function(){this.backgroud_bmp||(this.backgroud_bmp=weChat.LobbyResUtil.createBitmapByName("Login_bg_jpg"),this.backgroud_bmp.width=weChat.LobbyDataCache.defaultWidth,this.backgroud_bmp.height=egret.MainContext.instance.stage.stageHeight,egret.MainContext.instance.stage.addChild(this.backgroud_bmp)),this.darkLine_bmp||(this.darkLine_bmp=weChat.LobbyResUtil.createBitmapByName("Login_Progress_bg",428,491.5),this.addChild(this.darkLine_bmp)),this._pointArr||(this._pointArr=new egret.Sprite,this._pointArr.x=442.5,this._pointArr.y=493,this.addChild(this._pointArr)),this.lightLine_bmp||(this.lightLine_bmp=weChat.LobbyResUtil.createBitmapByName("Login_Brd",594,582.63),this.addChild(this.lightLine_bmp)),this.lightLine_bmp1||(this.lightLine_bmp1=weChat.LobbyResUtil.createBitmapByName("Login_bottom1",26.17,618.66),this.addChild(this.lightLine_bmp1)),this.lightLine_bmp2||(this.lightLine_bmp2=weChat.LobbyResUtil.createBitmapByName("Login_bottom2",220,652.98),this.addChild(this.lightLine_bmp2)),this._progTxt||(this._progTxt=weChat.LobbyResUtil.createTextFeild(16088615,egret.HorizontalAlign.CENTER,"",22,351,uniLib.Global.screenHeight-154,246)),this.explain_txf||(this.explain_txf=weChat.LobbyResUtil.createTextFeild(16088615,egret.HorizontalAlign.CENTER,"",24,490,uniLib.Global.screenHeight-180,246),this.addChild(this.explain_txf))},t.prototype.setProgress=function(e,t,i,n,o){if(void 0===o&&(o=!1),this._versionTxt||(this._versionTxt=weChat.LobbyResUtil.createTextFeild(10066329,egret.HorizontalAlign.RIGHT,weChat.LobbyDataCache.version,22,864),this._versionTxt.x=uniLib.Global.screenWidth-this._versionTxt.width,this._versionTxt.y=uniLib.Global.screenHeight-this._versionTxt.height,this.addChild(this._versionTxt),this._versionTxt.text=weChat.LobbyDataCache.version),t&&0!=t){var r=Math.ceil(e/t*100),a=this.pointNum[Math.round(r/10)-1];if(!a)return;this._pointArr.removeChildren();for(var s=0;a>s;s++){var h=new egret.Bitmap(RES.getRes("sz_Lobby_loadingPoint"));h.x=26.5*s,this._pointArr.addChild(h)}i&&""!=i&&(this.explain_txf.text=i),0==o&&r>93&&(r=93)}},t.prototype.destroy=function(){uniLib.DragonUtils.removeFastDragonbyContainer(this)},t.explain="正在加载游戏资源...",t}(egret.Sprite);__reflect(PublicLoadingView.prototype,"PublicLoadingView");var TJLoadingUI=function(e){function t(){var t=e.call(this)||this;return t.back=new egret.Sprite,t._loadingBG=new egret.Bitmap,t._loadingLogo=new egret.Bitmap,t.promptText=new egret.TextField,t.loadPanel=new egret.Sprite,t.text=["","",""],t.init(),t}return __extends(t,e),t.prototype.init=function(){this.back=uniLib.DisplayUtils.createMask(1,weChat.LobbyDataCache.defaultWidth,weChat.LobbyDataCache.defaultWidth,0),this.back.touchEnabled=!1,this.addChild(this.back),this.promptText.text=this.text[Math.floor(3*Math.random())],this.promptText.x=(640-this.promptText.width)/2,this.promptText.y=(1136-this.promptText.height)/2+180,this.addChild(this.promptText)},t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),egret.Tween.get(this._loadingBG,{loop:!0}).to({rotation:360},600),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this)},t.prototype.setProgress=function(e,t,i){},t.prototype.onRemoveFromStage=function(e){egret.Tween.removeTweens(this._loadingBG),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this)},t}(egret.Sprite);__reflect(TJLoadingUI.prototype,"TJLoadingUI");var weChat;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e._Score=0,e._distance=new egret.Point,e._touchStatus=!1,e.skinName="LobbyMainSceneSkin",e}return __extends(i,t),i.prototype.destory=function(){t.prototype.destory.call(this),uniLib.DragonUtils.removeFastDragonbyContainer(this),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i.prototype.addEvent=function(){BC.addEvent(this,this.standardScene,egret.TouchEvent.TOUCH_TAP,this.enterStandard),BC.addEvent(this,this.help,egret.TouchEvent.TOUCH_TAP,this.showHelp)},i.prototype.removeEvent=function(){BC.removeEvent(this,null,egret.TouchEvent.TOUCH_TAP,null),BC.removeEvent(this,uniLib.Global)},i.prototype.init=function(){this.initData()},i.prototype.initData=function(){},i.prototype.dataChangeHandler=function(e){e.data.iData;e.data.iType},i.prototype.enterStandard=function(){console.error("进入新手场"),this.BeginGame()},i.prototype.showHelp=function(){console.error("显示帮助"),e.weChatMsgCommand.instance.dispatchChangeEvent(e.LobbyUIEventConsts.LOBBY_SHOW_HELP,null)},i.prototype.BeginGame=function(){var t=new gameMain.BgContent;this.addChild(t);var i=new e.newGameScene;this.addChild(i),this.touchEnabled=!0},i.prototype.netControl=function(e){console.error("网络检测控制",e.data);var t=e.data;this.pingHandle(t)},i.prototype.pingHandle=function(t){var i=!1;this.pingArr||(this.pingArr=[]),this.pingArr.push(t),this.pingArr.length>2&&this.pingArr.shift();for(var n=0;n<this.pingArr.length;n++)this.pingArr[n]<500&&(i=!0);if(!i){if(e.variableCommon.getInstance().LobbyTempMap.has("网络不佳，处理中"))return;e.LobbyPopupManager.showMildWarnShow("网络不佳，处理中..")}},i}(e.BaseEuiPanel);e.LobbyMainGameLayer=t,__reflect(t.prototype,"weChat.LobbyMainGameLayer")}(weChat||(weChat={}));var weChat;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.addEvent(),e}return __extends(i,t),i.prototype.destory=function(){uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this.removeEvent()},i.prototype.addEvent=function(){e.weChatMsgCommand.instance.hasEventListener(e.LobbyUIEventConsts.DATA_CHANGE)||BC.addEvent(this,e.weChatMsgCommand.instance,e.LobbyUIEventConsts.DATA_CHANGE,this.dataChangeHandler)},i.prototype.removeEvent=function(){},i.prototype.dataChangeHandler=function(t){t.data.iData;switch(t.data.iType){case e.LobbyUIEventConsts.LOBBY_SHOW_HELP:this.showHelpPanel();break;case e.LobbyUIEventConsts.SHOW_RESTART_PANEL:this.showGameOverPanel();break;case e.LobbyUIEventConsts.SHOW_RANK:this.showRankPanel()}},i.prototype.updateData=function(){},i.prototype.showHelpPanel=function(){this._helpPanel||(this._helpPanel=new e.LobbyHelpPanel,this._helpPanel.name="lobbyHelp",BC.addEvent(this,this._helpPanel,e.LobbyUIEventConsts.CLOSE,this.closeHelp),e.LobbyPopupManager.addPopUp(["closeHelp",this],this._helpPanel,!0,!0,!0,1280,720))},i.prototype.closeHelp=function(){this._helpPanel&&(BC.removeEvent(this,this._helpPanel),e.LobbyPopupManager.removePopUp("closeHelp",this._helpPanel,!0),this._helpPanel.destory(),this._helpPanel=null)},i.prototype.showGameOverPanel=function(){this._gameOver||(this._gameOver=new e.gameOver,this._gameOver.name="gameOver",BC.addEvent(this,this._gameOver,e.LobbyUIEventConsts.CLOSE,this.closeGameOver),e.LobbyPopupManager.addPopUp(["closeGameOver",this],this._gameOver,!0,!0,!0,1280,720))},i.prototype.closeGameOver=function(){this._gameOver&&(BC.removeEvent(this,this._gameOver),e.LobbyPopupManager.removePopUp("closeGameOver",this._gameOver,!0),this._gameOver.destory(),this._gameOver=null)},i.prototype.showRankPanel=function(){this.rank||(this.rank=new e.rankPanel,this.rank.name="rank",BC.addEvent(this,this.rank,e.LobbyUIEventConsts.CLOSE,this.closeRank),e.LobbyPopupManager.addPopUp(["closeRank",this],this.rank,!0,!0,!0,1280,720))},i.prototype.closeRank=function(){this.rank&&(BC.removeEvent(this,this.rank),e.LobbyPopupManager.removePopUp("closeRank",this.rank,!0),this.rank.destory(),this.rank=null)},i}(egret.DisplayObjectContainer);e.LobbyPopLayer=t,__reflect(t.prototype,"weChat.LobbyPopLayer")}(weChat||(weChat={}));var weChat;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.skinName="LobbyMenuSkin",e}return __extends(i,t),i.prototype.destory=function(){t.prototype.destory.call(this),uniLib.DragonUtils.removeFastDragonbyContainer(this)},i.prototype.init=function(){this.touchEnabled=!1},i.prototype.addEvent=function(){BC.addEvent(this,this.resetMan,egret.TouchEvent.TOUCH_TAP,this.resetManHandle),BC.addEvent(this,this.rankBtn,egret.TouchEvent.TOUCH_TAP,this.showRank),BC.addEvent(this,this._left,egret.TouchEvent.TOUCH_BEGIN,this.leftHandle),BC.addEvent(this,this._left,egret.TouchEvent.TOUCH_END,this.leftHandle),BC.addEvent(this,this._left,egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.leftHandle),BC.addEvent(this,this._right,egret.TouchEvent.TOUCH_BEGIN,this.rightHandle),BC.addEvent(this,this._right,egret.TouchEvent.TOUCH_END,this.rightHandle),BC.addEvent(this,this._right,egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.rightHandle)},i.prototype.removeEvent=function(){BC.removeEvent(this,null,egret.TouchEvent.TOUCH_TAP,null),BC.removeEvent(this)},i.prototype.showRank=function(){e.weChatMsgCommand.instance.dispatchChangeEvent(e.LobbyUIEventConsts.SHOW_RANK,null)},i.prototype.resetManHandle=function(){e.weChatMsgCommand.instance.dispatchChangeEvent(e.LobbyUIEventConsts.RESET_MAN_POSITION,null)},i.prototype.leftHandle=function(t){e.weChatMsgCommand.instance.dispatchChangeEvent(e.LobbyUIEventConsts.TURN_LEFT,t)},i.prototype.rightHandle=function(t){e.weChatMsgCommand.instance.dispatchChangeEvent(e.LobbyUIEventConsts.TURN_RIGHT,t)},i}(e.BaseEuiPanel);e.MJLobbyMenuVc=t,__reflect(t.prototype,"weChat.MJLobbyMenuVc")}(weChat||(weChat={}));var gameMain;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.Init,t),t}return __extends(t,e),t.prototype.Init=function(){this.bgSpeed=5;var e=RES.getRes("background_png");this.bgbitmap1=new egret.Bitmap(e),this.bgbitmap1.width=weChat.GameManager.stageW,this.bgbitmap1.height=weChat.GameManager.stageH+10,this.addChild(this.bgbitmap1),this.bgbitmap2=new egret.Bitmap(e),this.bgbitmap2.width=weChat.GameManager.stageW,this.bgbitmap2.height=weChat.GameManager.stageH,this.addChild(this.bgbitmap2),this.bgbitmap1.x=0,this.bgbitmap1.y=0,this.bgbitmap2.x=0,this.bgbitmap2.y=weChat.GameManager.stageH+10,this.touchEnabled=!0,this.Run()},t.prototype.Run=function(){var e=this;this.addEventListener(egret.Event.ENTER_FRAME,function(){e.bgbitmap1.y-=e.bgSpeed,e.bgbitmap1.y<-weChat.GameManager.stageH&&(e.bgbitmap1.y=0),e.bgbitmap2.y-=e.bgSpeed,e.bgbitmap2.y<0&&(e.bgbitmap2.y=0+weChat.GameManager.stageH)},this)},t}(egret.DisplayObjectContainer);e.BgContent=t,__reflect(t.prototype,"gameMain.BgContent");var i;!function(e){e[e.ENEMY=0]="ENEMY",e[e.HERO=1]="HERO",e[e.OTHER=2]="OTHER"}(i=e.IdentityType||(e.IdentityType={}))}(gameMain||(gameMain={}));var p2DebugDraw=function(){function e(e){this.COLOR_D_SLEEP=10066329,this.COLOR_D_WAKE=15053490,this.COLOR_K=8355813,this.COLOR_S=8381823,this.factor=50,this.world=e}return e.prototype.setSprite=function(e){this.sprite=e},e.prototype.drawDebug=function(){this.sprite.graphics.clear();for(var e=this.world.bodies.length,t=0;e>t;t++)for(var i=this.world.bodies[t],n=0;n<i.shapes.length;n++){var o=i.shapes[n];o instanceof p2.Convex?this.drawConvex(o,i):o instanceof p2.Circle?this.drawCircle(o,i):o instanceof p2.Line?this.drawLine(o,i):o instanceof p2.Particle?this.drawParticle(o,i):o instanceof p2.Plane?this.drawPlane(o,i):o instanceof p2.Capsule&&this.drawCapsule(o,i)}},e.prototype.drawCircle=function(e,t){var i=this.getColor(t),n=this.sprite.graphics;n.lineStyle(1,i),n.beginFill(i,.5),n.drawCircle(t.position[0]*this.factor,1280-t.position[1]*this.factor,e.radius*this.factor);var o=new Array;t.toWorldFrame(o,[e.radius,0]),n.moveTo(t.position[0]*this.factor,t.position[1]*this.factor),n.lineTo(o[0],o[1]),n.endFill()},e.prototype.drawCapsule=function(e,t){var i=this.getColor(t),n=e.length,o=e.radius,r=new Array,a=new Array,s=new Array,h=new Array,l=new Array,c=new Array;t.toWorldFrame(r,[-n/2,-o]),t.toWorldFrame(a,[n/2,-o]),t.toWorldFrame(s,[n/2,o]),t.toWorldFrame(h,[-n/2,o]),t.toWorldFrame(l,[n/2,0]),t.toWorldFrame(c,[-n/2,0]);var u=this.sprite.graphics;u.lineStyle(1,i),u.beginFill(i,.5),u.drawCircle(l[0],l[1],o),u.endFill(),u.lineStyle(1,i),u.beginFill(i,.5),u.drawCircle(c[0],c[1],o),u.endFill(),u.lineStyle(1,i),u.beginFill(i,.5),u.moveTo(r[0],r[1]),u.lineTo(a[0],a[1]),u.lineTo(s[0],s[1]),u.lineTo(h[0],h[1]),u.endFill()},e.prototype.drawLine=function(e,t){var i=this.getColor(t),n=e.length*this.factor,o=new Array,r=new Array;t.toWorldFrame(o,[-n/2,0]),t.toWorldFrame(r,[n/2,0]);var a=this.sprite.graphics;a.lineStyle(1,i),a.moveTo(o[0],o[1]),a.lineTo(r[0],r[1]),a.endFill()},e.prototype.drawParticle=function(e,t){var i=this.getColor(t),n=this.sprite.graphics;n.lineStyle(1,i),n.beginFill(i,.5),n.drawCircle(t.position[0],t.position[1],1),n.endFill(),n.lineStyle(1,i),n.drawCircle(t.position[0],t.position[1],5),n.endFill()},e.prototype.drawConvex=function(e,t){var i=this.getColor(t),n=e.vertices.length,o=this.sprite.graphics;o.lineStyle(1,i),o.beginFill(i,.5);var r=new Array;t.toWorldFrame(r,e.vertices[0]),o.moveTo(t.position[0],t.position[1]),o.lineTo(r[0],r[1]);for(var a=1;n>=a;a++)t.toWorldFrame(r,e.vertices[a%n]),o.lineTo(r[0],r[1]);o.endFill()},e.prototype.drawPlane=function(e,t){var i=this.COLOR_D_SLEEP,n=this.sprite.graphics;n.lineStyle(1,i),n.beginFill(i,1);var o=new Array,r=new Array;t.toWorldFrame(o,[-1e3,0]),n.moveTo(o[0],o[1]),t.toWorldFrame(r,[1e3,0]),n.lineTo(r[0],r[1]),t.toWorldFrame(r,[1e3,-1e3]),n.lineTo(r[0],r[1]),t.toWorldFrame(r,[-1e3,-1e3]),n.lineTo(r[0],r[1]),t.toWorldFrame(r,[-1e3,-0]),n.lineTo(r[0],r[1]),n.endFill()},e.prototype.getColor=function(e){var t=this.COLOR_D_SLEEP;return e.type==p2.Body.KINEMATIC?t=this.COLOR_K:e.type==p2.Body.STATIC?t=this.COLOR_S:e.sleepState==p2.Body.AWAKE&&(t=this.COLOR_D_WAKE),t},e}();__reflect(p2DebugDraw.prototype,"p2DebugDraw");var weChat;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.init(),e}return __extends(i,t),i.prototype.init=function(){this.setUI()},i.prototype.setUI=function(){var t=egret.MainContext.instance.stage.stageHeight,i=egret.MainContext.instance.stage.stageWidth,n=e.GameManager.getCurScore(),o=new egret.Shape;o.graphics.beginFill(0,.6),o.graphics.drawRect(0,0,i,t),o.graphics.endFill(),this.addChild(o);var r=new egret.Bitmap;r.texture=RES.getRes("uiback_png"),this.addChild(r),r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.x=i/2,r.y=t/2;var a=new egret.Bitmap;a.texture=RES.getRes("title_end_png"),this.addChild(a),a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.x=r.x,a.y=r.y-r.height/2;var s=new egret.Bitmap;s.texture=RES.getRes("myscore_png"),s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,s.x=r.x,s.y=r.y-r.height/4,this.addChild(s);var h=new egret.TextField;h.x=s.x+.1*s.width,h.y=s.y,h.size=36,h.textAlign="center",h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2,h.textColor=16777215,h.text=""+n,this.addChild(h);var l=new egret.Bitmap;l.texture=RES.getRes("hightscore_png"),l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,l.x=r.x,l.y=r.y,this.addChild(l);
var c=new egret.TextField;c.x=h.x,c.y=l.y,c.size=36,c.textAlign="center",c.anchorOffsetX=c.width/2,c.anchorOffsetY=c.height/2,c.textColor=16777215,this.addChild(c);var u=egret.localStorage.getItem("maxScore"),d=Number(u);n>d&&(d=n,egret.localStorage.setItem("maxScore",""+d)),c.text=""+d;var p=new egret.Bitmap;p.texture=RES.getRes("again_png"),this.addChild(p),p.anchorOffsetX=p.width/2,p.anchorOffsetY=p.height/2,p.x=r.x-r.width/5,p.y=r.y+r.height/4,p.touchEnabled=!0,p.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.restartBtnCallback,this),p.addEventListener(egret.TouchEvent.TOUCH_END,this.restartBtnCallback,this),p.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.restartBtnCallback,this);var g=new egret.Bitmap;g.texture=RES.getRes("shareBtn_png"),this.addChild(g),g.anchorOffsetX=g.width/2,g.anchorOffsetY=g.height/2,g.x=r.x+r.width/5,g.y=r.y+r.height/4,g.touchEnabled=!0,g.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shareBtnCallback,this),g.addEventListener(egret.TouchEvent.TOUCH_END,this.shareBtnCallback,this),g.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.shareBtnCallback,this)},i.prototype.restartBtnCallback=function(t){if(t.type==egret.TouchEvent.TOUCH_BEGIN)t.currentTarget.scaleX=1.05,t.currentTarget.scaleY=1.05;else if(t.type==egret.TouchEvent.TOUCH_END){t.currentTarget.scaleX=1,t.currentTarget.scaleY=1,this.parent.world.clear(),egret.MainContext.instance.stage.removeChildren();var i=new e.newGameScene;egret.MainContext.instance.stage.addChild(i)}else t.type==egret.TouchEvent.TOUCH_RELEASE_OUTSIDE&&(t.currentTarget.scaleX=1,t.currentTarget.scaleY=1)},i.prototype.shareBtnCallback=function(e){e.type==egret.TouchEvent.TOUCH_BEGIN?(e.currentTarget.scaleX=1.05,e.currentTarget.scaleY=1.05):e.type==egret.TouchEvent.TOUCH_END?(e.currentTarget.scaleX=1,e.currentTarget.scaleY=1,window.open("http://pipigo.wsq.umeng.com")):e.type==egret.TouchEvent.TOUCH_RELEASE_OUTSIDE&&(e.currentTarget.scaleX=1,e.currentTarget.scaleY=1)},i}(egret.Sprite);e.FailedLayer=t,__reflect(t.prototype,"weChat.FailedLayer")}(weChat||(weChat={}));var weChat;!function(e){var t=function(t){function i(e){var i=t.call(this)||this;return i.factor=50,i.stayTime=0,i.preScore=0,i.curScore=0,i.gameScene=e,i.init(e),i}return __extends(i,t),i.prototype.init=function(e){this.isRight=!0,this.stageH=egret.MainContext.instance.stage.stageHeight,this.stageW=egret.MainContext.instance.stage.stageWidth,this.hero=e.hero,this.heroBody=e.heroBody,this.heroBody1=e.heroBody1,this.setUI(),this.addevent()},i.prototype.addevent=function(){BC.addEvent(this,e.weChatMsgCommand.instance,e.LobbyUIEventConsts.DATA_CHANGE,this.dataChangeHandler)},i.prototype.dataChangeHandler=function(t){var i=t.data.iData;switch(t.data.iType){case e.LobbyUIEventConsts.RESET_MAN_POSITION:this.heroStay();break;case e.LobbyUIEventConsts.TURN_LEFT:this.leftBtnCallback(i);break;case e.LobbyUIEventConsts.TURN_RIGHT:this.rightBtnCallback(i);break;case e.LobbyUIEventConsts.PILES_CHANGE:this.pilesHandle();break;case e.LobbyUIEventConsts.RE_START:this.reStart()}},i.prototype.setUI=function(){var e=this.stageW,t=this.stageH,i=new egret.TextField;this.addChild(i),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.x=.85*e,i.y=.05*t,i.size=30,i.textAlign="center",i.text="0",i.textColor=16777215,i.fontFamily="Arial",i.italic=!0,this.scoreLabel=i;var n=new egret.TextField;this.addChild(n),n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=.5*e,n.y=.05*t,n.size=30,n.textAlign="center",n.text="0",n.textColor=16777215,n.fontFamily="Arial",this.pilesLabel=n;var o=new egret.Bitmap;o.texture=RES.getRes("time_png"),this.addChild(o),o.anchorOffsetX=0,o.anchorOffsetY=0,o.x=.9*e,o.y=.4*t,o.visible=!1,this.timeBarBg=o;var r=new egret.Bitmap;r.texture=RES.getRes("time2_png"),this.addChild(r),r.anchorOffsetX=0,r.anchorOffsetY=0,r.x=o.x,r.y=o.y,r.mask=new egret.Rectangle(0,0,r.width,r.height),r.visible=!1,this.timeBar=r,this.leftTimer=new egret.Timer(1e3/60,0),this.leftTimer.addEventListener(egret.TimerEvent.TIMER,this.leftMove,this),this.rightTimer=new egret.Timer(1e3/60,0),this.rightTimer.addEventListener(egret.TimerEvent.TIMER,this.rightMove,this),this.heroState=new egret.Timer(1e3/60,0),this.heroState.addEventListener(egret.TimerEvent.TIMER,this.heroStateHandle,this),this.heroState.start()},i.prototype.updateScore=function(e){this.curScore=e,this.scoreLabel.text=""+e},i.prototype.leftBtnCallback=function(t){t.type==egret.TouchEvent.TOUCH_BEGIN?(this.isRight=!1,this.leftTimer.start(),e.variableCommon.getInstance().hero.stateHandle(1),this.heroState.stop()):t.type==egret.TouchEvent.TOUCH_END?(this.heroBody.velocity[0]=1,this.leftTimer.reset(),this.heroState.start()):t.type==egret.TouchEvent.TOUCH_RELEASE_OUTSIDE&&(this.heroBody.velocity[0]=1,this.heroState.start())},i.prototype.rightBtnCallback=function(t){t.type==egret.TouchEvent.TOUCH_BEGIN?(this.isRight=!0,e.variableCommon.getInstance().hero.stateHandle(2),this.heroState.stop(),this.rightTimer.start()):t.type==egret.TouchEvent.TOUCH_END?(this.heroBody.velocity[0]=1,this.rightTimer.reset(),this.heroState.start()):t.type==egret.TouchEvent.TOUCH_RELEASE_OUTSIDE&&(this.heroState.start(),this.heroBody.velocity[0]=1,t.currentTarget.scaleX=1,t.currentTarget.scaleY=1)},i.prototype.leftMove=function(){var e=this.heroBody;e.velocity[0]>-7?e.force[0]=-.7*this.factor:e.velocity[0]=-7},i.prototype.rightMove=function(){var e=this.heroBody;e.velocity[0]<7?e.force[0]=.7*this.factor:e.velocity[0]=7},i.prototype.heroStay=function(){var e=this.heroBody;e.velocity[0]=0,e.position[1]=egret.MainContext.instance.stage.stageHeight/50-2,e.position[0]=5},i.prototype.heroStateHandle=function(){var t=this.heroBody;t.velocity[1]>0?this.isRight?e.variableCommon.getInstance().hero.stateHandle(0):e.variableCommon.getInstance().hero.stateHandle(4):t.velocity[1]<=0&&(this.isRight?e.variableCommon.getInstance().hero.stateHandle(3):e.variableCommon.getInstance().hero.stateHandle(5))},i.prototype.timeBarCallback=function(){var e=this.timeBar;if(this.curScore>this.preScore)this.timeBarBg.visible=!1,e.visible=!1,e.mask=new egret.Rectangle(0,0,e.width,e.height),this.timeBarTimer.reset(),this.heroStayTimer.start();else{var t=e.height/10*this.timeBarTimer.currentCount;e.mask=new egret.Rectangle(0,t,e.width,e.height-t),this.timeBarTimer.currentCount>=10&&(this.timeBarTimer.reset(),this.hero.changeDied())}},i.prototype.pilesHandle=function(){this.pilesLabel.text="第"+e.variableCommon.getInstance().pilesNum+"层"},i.prototype.reStart=function(){e.variableCommon.getInstance().pilesNum=0,this.gameScene.reStart(),this.heroStay()},i}(egret.Sprite);e.GameHud=t,__reflect(t.prototype,"weChat.GameHud")}(weChat||(weChat={}));var weChat;!function(e){var t=function(){function e(){}return e.setCurScore=function(e){this._curScore=e},e.getCurScore=function(){return this._curScore},e.stageW=720,e.stageH=1280,e._curScore=0,e}();e.GameManager=t,__reflect(t.prototype,"weChat.GameManager")}(weChat||(weChat={}));var weChat;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.skinName="gameOverSkin",e}return __extends(i,t),i.prototype.destory=function(){t.prototype.destory.call(this),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i.prototype.addEvent=function(){BC.addEvent(this,this.yesBtn,egret.TouchEvent.TOUCH_TAP,this.start),BC.addEvent(this,this.noBtn,egret.TouchEvent.TOUCH_TAP,this.noticeCloseHander)},i.prototype.removeEvent=function(){BC.removeEvent(this,null,egret.TouchEvent.TOUCH_TAP,null),BC.removeEvent(this,uniLib.Global)},i.prototype.init=function(){this.initData()},i.prototype.initData=function(){this.grade.text="很遗憾你的成绩是第"+e.variableCommon.getInstance().pilesNum+"层"},i.prototype.dataChangeHandler=function(e){e.data.iData;e.data.iType},i.prototype.start=function(){this.dispatchEventWith(e.LobbyUIEventConsts.CLOSE),e.weChatMsgCommand.instance.dispatchChangeEvent(e.LobbyUIEventConsts.RE_START,null)},i.prototype.noticeCloseHander=function(){this.dispatchEventWith(e.LobbyUIEventConsts.CLOSE)},i}(e.BaseEuiPanel);e.gameOver=t,__reflect(t.prototype,"weChat.gameOver")}(weChat||(weChat={}));var weChat;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.stateArr=[],e.init(),e}return __extends(i,t),i.prototype.init=function(){this.sprite=new egret.Bitmap,this.changeNormal();var t=RES.getRes("heroMC_json"),i=RES.getRes("heroMC_png"),n=new egret.MovieClipDataFactory(t,i);new egret.MovieClip;this.mcDataFactory=n;var o=e.LobbyResUtil.createMovieClicp("jumpMc","stand");this._standData=o.movieClipData,o=e.LobbyResUtil.createMovieClicp("jumpMc","runfast"),this._runData=o.movieClipData,o=e.LobbyResUtil.createMovieClicp("jumpMc","fly"),this._flyData=o.movieClipData,this._hero=e.LobbyResUtil.createMovieClicp("jumpMc","stand"),this._hero.play(-1),this._hero.scaleX=this._hero.scaleY=.5,this.addChild(this._hero),this.stateArr=[],this.stateArr.push(this._standData),this.stateArr.push(this._runData),this.stateArr.push(this._runData),this.stateArr.push(this._flyData),this.stateArr.push(this._standData),this.stateArr.push(this._flyData),this.rundTimer=new egret.Timer(1e3,0),this.rundTimer.addEventListener(egret.TimerEvent.TIMER,this.changeNormal,this)},i.prototype.changeDied=function(){},i.prototype.changeNormal=function(){-1!=this.getChildIndex(this._hero)&&this.removeChild(this._hero),-1==this.getChildIndex(this.sprite)&&this.addChild(this.sprite),this.sprite.texture=RES.getRes("ball1_png"),this.anchorOffsetX=this.sprite.width/2,this.anchorOffsetY=this.sprite.height/2},i.prototype.attackedCallback=function(){this.rundTimer.currentCount>=1&&(this.rundTimer.reset(),this.changeNormal())},i.prototype.stateHandle=function(e){1==e||4==e||5==e?this._hero.scaleX=-.5:this._hero.scaleX=.5,this._hero.movieClipData=this.stateArr[e],this._hero.play(-1)},i}(egret.Sprite);e.Hero=t,__reflect(t.prototype,"weChat.Hero")}(weChat||(weChat={}));var weChat;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.curScore=0,e._isDebug=!1,e.floatFloorSpeedX=6,e.gravity=-10,e.jumpSpeed=1,e.gameSpeed=3,e.stableFloor_MAX=5,e.stableFloor_min=3,e.breakableFloor_MAX=4,e.floatFloor_MAX=3,e.floatFloor=[],e.stableFloor=[],e.breakableFloor=[],e.props=[],e.propDisplays=[],e.posArray=[],e.lastPosy=0,e._debug=!1,e.isFall=!1,e.init(),e}return __extends(i,t),i.prototype.init=function(){this.touchEnabled=!0,this.setUI()},i.prototype.createDebug=function(e){this.debugDraw=new p2DebugDraw(e);var t=new egret.Sprite;t.width=egret.MainContext.instance.stage.stageWidth,t.height=egret.MainContext.instance.stage.stageHeight,t.name="debugDraw",this.addChild(t),this.debugDraw.setSprite(t)},i.prototype.initView=function(){this.egretContain=new egret.DisplayObject},i.prototype.setUI=function(){var t=egret.MainContext.instance.stage.stageWidth,i=egret.MainContext.instance.stage.stageHeight;this.stageH=i,this.stageW=t;var n=50;this.factor=n;var o=t/n,r=i/n;this.worldW=o,this.worldH=r,this.lastPosy=-r,this.world=new p2.World,this.world.emitImpactEvent=!1,this.world.sleepMode=p2.World.BODY_SLEEPING,egret.Ticker.getInstance().register(this.worldLogic,this);var a=new e.Hero,s=new p2.Circle({radius:.35*a.height/n});s.material=new p2.Material(1);var h=new p2.Body({mass:1,position:[.5*t/n,.5*i/n],type:p2.Body.DYNAMIC,fixedRotation:!0,inertia:1,dadamping:-1e3,rerestitution:-1e3});if(h.addShape(s),h.angularDamping=0,h.damping=0,h.allowSleep=!1,h.velocity=[0,this.jumpSpeed],this.world.addBody(h),this._isDebug){var l=this.createBall(s.radius*n);l.width=2*s.radius*n,l.height=2*s.radius*n,l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,h.displays=[a]}else h.displays=[a];this.addChild(a);for(var c=1;5>=c;c++){var u=new e.Prop(c);this.propDisplays.push(u);var d=new p2.Body;this.props.push(d)}this.hero=a,e.variableCommon.getInstance().hero=this.hero,this.heroBody=h,this.heroShape=s,this.world=this.world,this.spritePool=new e.SpritePool,this.gameHud=new e.GameHud(this),this.addChild(this.gameHud),this.createDebug(this.world);var p=new egret.Timer(500,0);p.addEventListener(egret.TimerEvent.TIMER,function(){},this),p.start(),this.addSidesteps(-1,!0),this.addSidesteps(0,!0),this.addSidesteps(1,!0);var g=this.curFloor,f=(this.preFloor,this.curScore,this.props,this.propDisplays,this.breakableFloor);this.world.on("beginContact",function(e){console.error("碰撞开始函数"),(e.bodyA==h||e.bodyB==h)&&(e.bodyA==h&&-1==f.indexOf(e.bodyB)?g=e.bodyB:e.bodyB==h&&-1==f.indexOf(e.bodyA)&&(g=e.bodyA))},this),this.world.on("endContact",function(e){g=null;var t=f.indexOf(e.bodyA);if(-1==t&&(t=f.indexOf(e.bodyB)),-1!=t&&h.position[1]>f[t].position[1]){var n=f[t].displays[0];n.changeTexture(!0);var o=egret.Tween.get(n);o.to({y:i},1e3),o.call(function(){n.changeTexture(!1),this.spritePool.recycleObject(n),egret.setTimeout(function(){egret.Tween.removeTweens(o)},this,100)},this),this.world.removeBody(f.splice(t,1)[0])}},this),this.world.on("postStep",function(){var e=this,t=(this.hero,this.heroBody),i=this.heroShape,n=i.radius;t.gravityScale=1,t.velocity[1]<this.gravity&&(t.velocity[1]=1.5*this.gravity),t.position[0]+n<=0?(t.velocity[0]=0,t.position[0]=n):t.position[0]-n>=o&&(t.velocity[0]=0,t.position[0]=o-n),t.velocity[0]>8&&(t.velocity[0]=8),t.velocity[1]>0&&t.position[1]>=.95*r&&(t.velocity[1]=1*this.gravity,this.isFall||(t.type=p2.Body.KINEMATIC,egret.setTimeout(function(){e.isFall=!1,t.type=p2.Body.DYNAMIC},this,200))),t.position[1]<=.1*r&&this.stopWorld(),t.position[1]<=.6*r&&(t.type=p2.Body.DYNAMIC);for(var a=this.world.bodies.length,s=0;a>s;s++){var h=this.world.bodies[s];h!=t&&(h.velocity[1]=this.gameSpeed)}},this),this._isDebug},i.prototype.addSidesteps=function(t,i){i?e.variableCommon.getInstance().pilesNum=1:e.variableCommon.getInstance().pilesNum=e.variableCommon.getInstance().pilesNum+1;var n=this.world,o=this.heroShape,r=this.factor,a=this.spritePool,s=this.worldW,h=(this.worldH,this.props,this.propDisplays,Math.floor(Math.random()*(this.stableFloor_MAX+1-this.stableFloor_min)+this.stableFloor_min)),l=Math.floor(Math.random()*this.breakableFloor_MAX+1),c=Math.floor(Math.random()*this.floatFloor_MAX+1);console.error(" ran1",h," ran2y",l,"ran3",c);var u=a.getObject(1),d=.6*u.width/r;a.recycleObject(u);for(var p=h+l+c,g=0;p>g;g++){var f=Math.floor(Math.random()*s);f+d/2>=s?f=s-d/2:0>=f-d/2&&(f=d/2);var _=this.lastPosy+e.variableCommon.space;if(this.lastPosy=_,console.error("随机添加台阶",this.lastPosy),this.posArray.push([f,_]),this.lastPosy>0)break}h=Math.floor(h/p*this.posArray.length),l=Math.floor(l/p*this.posArray.length),c=this.posArray.length-h-l;var v,y,m=new p2.Material(0),b=new p2.Material(2);if(h>0)for(var g=0;h>g;g++){var C=this.posArray.splice(Math.floor(Math.random()*this.posArray.length),1)[0];if(0==this.posArray.length)break;if(0!=C[0]||0!=C[1]){var E=a.getObject(1);if(v=new p2.Box({width:3.5,height:1}),v.material=m,y=new p2.Body({mass:0,position:C}),y.addShape(v),y.angularDamping=0,y.damping=0,y.type=p2.Body.KINEMATIC,n.addBody(y),this.stableFloor.push(y),this._isDebug){var L=this.createBox(v.width*r,v.height*r,y.position[1]);L.anchorOffsetX=L.width/2,L.anchorOffsetY=L.height/2,y.displays=[L],this.addChild(L),E.anchorOffsetX=E.width/2,E.anchorOffsetY=E.height/2,y.displays=[E],this.addChild(E)}else E.anchorOffsetX=E.width/2,E.anchorOffsetY=E.height/2,y.displays=[E],this.addChild(E)}}if(l>0)for(var g=0;l>g;g++){var E=a.getObject(2);if(v=new p2.Box({width:3.5,height:1}),0==this.posArray.length)break;var C=this.posArray.splice(Math.floor(Math.random()*this.posArray.length),1)[0];if(0!=C[0]||0!=C[1])if(v.material=m,y=new p2.Body({mass:1,position:C}),y.addShape(v),y.angularDamping=0,y.damping=0,y.type=p2.Body.KINEMATIC,n.addBody(y),this.breakableFloor.push(y),this._isDebug){var L=this.createBox(v.width*r,v.height*r,y.position[1]);L.anchorOffsetX=L.width/2,L.anchorOffsetY=L.height/2,y.displays=[L],this.addChild(L),console.error("添加砖块2",y.position)}else E.anchorOffsetX=E.width/2,E.anchorOffsetY=E.height/2,y.displays=[E],this.addChild(E)}if(c>0)for(var g=0;c>g;g++){var E=a.getObject(3);if(v=new p2.Box({width:3.5,height:1}),0==this.posArray.length)break;var C=this.posArray.splice(Math.floor(Math.random()*this.posArray.length),1)[0];if(0!=C[0]||0!=C[1])if(v.material=m,y=new p2.Body({mass:0,position:C}),y.addShape(v),y.angularDamping=0,y.damping=0,y.fixedRotation=!0,y.type=p2.Body.KINEMATIC,y.velocity=[Math.floor(Math.random()*this.floatFloorSpeedX+1),0],n.addBody(y),this.floatFloor.push(y),this._isDebug){var L=this.createBox(v.width*r,v.height*r,y.position[1]);L.anchorOffsetX=L.width/2,L.anchorOffsetY=L.height/2,y.displays=[L],this.addChild(L)}else E.anchorOffsetX=E.width/2,E.anchorOffsetY=E.height/2,y.displays=[E],this.addChild(E)}var T=new p2.ContactMaterial(m,o.material);T.surfaceVelocity=0,T.friction=.5,T.restitution=0,n.addContactMaterial(T);var w=new p2.ContactMaterial(b,o.material);w.restitution=0,w.stiffness=1e3,w.contactSkinSize=1e4,n.addContactMaterial(w)},i.prototype.worldLogic=function(e){var t=this.world,i=this.factor,n=this.stageH,o=this.heroBody,r=this.floatFloor,a=this.stableFloor,s=this.breakableFloor,h=this.spritePool,l=(this.props,this.propDisplays,this.worldW),c=this.worldH;if(!(10>e||e>1e3)){t.step(e/1e3),this.getChildIndex(this.hero)<this.numChildren-2&&this.setChildIndex(this.hero,this.numChildren-2),this.getChildIndex(this.gameHud)<this.numChildren-1&&this.setChildIndex(this.gameHud,this.numChildren-1);for(var u=!0,d=t.bodies.length,p=0;d>p;p++){var g=t.bodies[p];if(g!=o&&g.position[1]<o.position[1]+.3*c&&u&&(u=!1),g.displays){var f=g.displays[0];f&&(f.x=g.position[0]*i,f.y=n-g.position[1]*i,f.rotation=360-180*g.angle/Math.PI,g.sleepState==p2.Body.SLEEPING?f.alpha=.5:f.alpha=1)}}for(var _=!0,v=a[0].shapes[0].width/2,p=0;p<r.length;p++)r[p].position[0]+v>l?(r[p].position[0]=l-v,r[p].velocity[0]=-r[p].velocity[0]):r[p].position[0]-v<0&&(r[p].position[0]=v,r[p].velocity[0]=-r[p].velocity[0]),r[p].position[1]<3&&(_=!1),r[p].position[1]>c&&(h.recycleObject(r[p].displays[0]),t.removeBody(r.splice(p,1)[0]),p--);for(var p=0;p<a.length;p++)a[p].position[1]<0&&(_=!1),a[p].position[1]>c&&(h.recycleObject(a[p].displays[0]),t.removeBody(a.splice(p,1)[0]),p--);for(var p=0;p<s.length;p++)s[p].position[1]<3&&(_=!1),s[p].position[1]>c&&(h.recycleObject(s[p].displays[0]),t.removeBody(s.splice(p,1)[0]),p--);_&&(this.lastPosy=-c,console.log("在屏幕上方1个屏幕大小区域创建备用台阶: ",c),this.addSidesteps(1,!1))}},i.prototype.stopWorld=function(){egret.Ticker.getInstance().unregister(this.worldLogic,this),e.variableCommon.getInstance().showReStartPanel()},i.prototype.reStart=function(){egret.Ticker.getInstance().register(this.worldLogic,this)},i.prototype.createBox=function(e,t,i){var n=new egret.Sprite,o=new egret.Shape;o.graphics.beginFill(16773120),o.graphics.drawRect(0,0,e,t),o.graphics.endFill();var r=new egret.TextField;return r.text=(""+i).substring(0,6),r.x=70,n.addChild(o),n.addChild(r),n},i.prototype.createBall=function(e){var t=new egret.Shape;return t.graphics.beginFill(16773120),t.graphics.drawCircle(e,e,e),t.graphics.endFill(),t},i}(egret.Sprite);e.newGameScene=t,__reflect(t.prototype,"weChat.newGameScene")}(weChat||(weChat={}));var weChat;!function(e){var t=function(e){function t(t){var i=e.call(this)||this;return i.init(t),i}return __extends(t,e),t.prototype.init=function(e){var t=new egret.Bitmap;switch(e){case 1:t.texture=RES.getRes("flow2__png"),this.anchorOffsetX=t.width/2,this.anchorOffsetY=t.height/2,this.addChild(t);break;case 2:t.texture=RES.getRes("flow1__png"),this.anchorOffsetX=t.width/2,this.anchorOffsetY=t.height/2,this.addChild(t);break;case 3:t.texture=RES.getRes("prop1_png"),this.anchorOffsetX=t.width/2,this.anchorOffsetY=t.height/2,this.addChild(t);break;case 4:t.texture=RES.getRes("prop0_png"),this.anchorOffsetX=t.width/2,this.anchorOffsetY=t.height/2,this.addChild(t);break;case 5:var i=RES.getRes("enemyMC_json"),n=RES.getRes("enemyMC_png");this.mcDataFactory=new egret.MovieClipDataFactory(i,n),this.heroMC=new egret.MovieClip,this.addChild(this.heroMC),this.heroMC.addEventListener(egret.Event.ENTER_FRAME,this.completemc,this),this.heroMC.anchorOffsetX=-this.heroMC.width/2,this.heroMC.anchorOffsetY=-this.heroMC.height/2}},t.prototype.playLeftAttack=function(){this.heroMC.movieClipData=this.mcDataFactory.generateMovieClipData("leftAttack"),this.heroMC.play(1)},t.prototype.playRightAttack=function(){this.heroMC.movieClipData=this.mcDataFactory.generateMovieClipData("rightAttack"),this.heroMC.play(1)},t.prototype.playStand=function(){this.heroMC.movieClipData=this.mcDataFactory.generateMovieClipData("stand"),this.heroMC.play(-1)},t.prototype.completemc=function(e){"end"==this.heroMC.currentFrameLabel&&this.playStand()},t}(egret.Sprite);e.Prop=t,__reflect(t.prototype,"weChat.Prop")}(weChat||(weChat={}));var weChat;!function(e){var t=function(e){function t(t){var i=e.call(this)||this;return i.init(t),i}return __extends(t,e),t.prototype.init=function(e){this.type=e;var t=new egret.Bitmap;1==e||3==e?t.texture=RES.getRes("enemy2_png"):2==e&&(t.texture=RES.getRes("line1_png")),this.anchorOffsetX=t.width/2,this.anchorOffsetY=0,this.addChild(t),this.sprite=t;var i=this.createBox(t.width,t.height);i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2},t.prototype.changeTexture=function(e){e?this.sprite.texture=RES.getRes("line3_png"):this.sprite.texture=RES.getRes("line1_png")},t.prototype.createBox=function(e,t){var i=new egret.Sprite,n=new egret.Shape;return n.graphics.beginFill(16773120),n.graphics.drawRect(0,0,e,t),n.graphics.endFill(),i.addChild(n),i},t}(egret.Sprite);e.SideStep=t,__reflect(t.prototype,"weChat.SideStep")}(weChat||(weChat={}));var weChat;!function(e){var t=function(){function t(){this.init()}return t.prototype.init=function(){this._pool1=[],this._pool2=[],this._pool3=[]},t.prototype.getObject=function(t){return 1==t?this._pool1.length>0?this._pool1.pop():new e.SideStep(1):2==t?this._pool2.length>0?this._pool2.pop():new e.SideStep(2):3==t?this._pool3.length>0?this._pool3.pop():new e.SideStep(3):void 0},t.prototype.recycleObject=function(e){1==e.type?this._pool1.push(e):2==e.type?this._pool2.push(e):3==e.type&&this._pool3.push(e),e&&e.parent&&e.parent.removeChild(e)},t}();e.SpritePool=t,__reflect(t.prototype,"weChat.SpritePool")}(weChat||(weChat={}));var HaoCaiTipLoading=function(e){function t(){var t=e.call(this)||this;return t.init(),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStageHandler,t),t}return __extends(t,e),t.prototype.init=function(){weChat.LobbyResUtil.removeAllChildren(this);var e=new eui.Rect(weChat.LobbyDataCache.defaultWidth,weChat.LobbyDataCache.defaultHeight,0);e.alpha=.45,this.addChildAt(e,0)},t.prototype.onAddToStageHandler=function(e){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStageHandler,this),this._loadingMc1=weChat.LobbyResUtil.createMovieClicp("sz_Lobby_Loading","loadingMc1"),this._loadingMc1.x=weChat.LobbyDataCache.defaultWidth/2,this._loadingMc1.y=weChat.LobbyDataCache.defaultHeight/2-15,this._loadingMc1.play(-1),egret.MainContext.instance.stage.addChild(this._loadingMc1),this.addChild(this._loadingMc1)},t.prototype.onRemoveFromStageHandler=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStageHandler,this),uniLib.DragonUtils.removeFastDragonbyContainer(this),this._loadingMc1&&this._loadingMc1.stop(),this._loadingMc1=null,weChat.LobbyResUtil.removeFromParent(this)},t.prototype.setProgress=function(){},t}(egret.Sprite);__reflect(HaoCaiTipLoading.prototype,"HaoCaiTipLoading");var weChat;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.toggleArr=[],e.skinName="LobbyHelpPanelSkin",e}return __extends(i,t),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.helpContent2.parent.removeChild(this.helpContent2)},i.prototype.init=function(){this.toggleArr=[this.hundredBtn,this.standardBtn]},i.prototype.addEvent=function(){BC.addEvent(this,this.helpClose,egret.TouchEvent.TOUCH_TAP,this.helpCloseHander),BC.addEvent(this,this.hundredBtn,eui.UIEvent.CHANGE,this.toggleChangeHandler),BC.addEvent(this,this.standardBtn,eui.UIEvent.CHANGE,this.toggleChangeHandler)},i.prototype.removeEvent=function(){BC.removeEvent(this,null,egret.TouchEvent.TOUCH_TAP,null)},i.prototype.helpCloseHander=function(){this.dispatchEventWith(e.LobbyUIEventConsts.CLOSE)},i.prototype.toggleChangeHandler=function(e){for(var t=0;t<this.toggleArr.length;t++){var i=this.toggleArr[t];i.selected=i==e.target}uniLib.SoundMgr.instance.playSound("buttonSwitch_mp3"),this.switchContent(e.target.name)},i.prototype.switchContent=function(e){switch(this.helpScroll.stopAnimation(),e){case"standard":this.helpContent2.parent&&this.helpContent2.parent.removeChild(this.helpContent2),this.helpGroup.addChild(this.helpContent1);break;case"hundred":this.helpContent1.parent&&this.helpContent1.parent.removeChild(this.helpContent1),this.helpGroup.addChild(this.helpContent2)}this.helpScroll.viewport.scrollV=0},i.prototype.destory=function(){t.prototype.destory.call(this)},i}(e.BaseEuiPanel);e.LobbyHelpPanel=t,__reflect(t.prototype,"weChat.LobbyHelpPanel")}(weChat||(weChat={}));var weChat;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.skinName="RankPanelSkin",e}return __extends(i,t),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.rankScroll.height=e.variableCommon.getInstance().sclaeNum-117},i.prototype.init=function(){t.prototype.init.call(this)},i.prototype.addEvent=function(){BC.addEvent(this,this.rankBack,egret.TouchEvent.TOUCH_TAP,this.noticeCloseHander)},i.prototype.removeEvent=function(){BC.removeEvent(this,null,egret.TouchEvent.TOUCH_TAP,null)},i.prototype.noticeCloseHander=function(){this.dispatchEventWith(e.LobbyUIEventConsts.CLOSE)},i.prototype.destory=function(){t.prototype.destory.call(this)},i}(e.BaseEuiPanel);e.rankPanel=t,__reflect(t.prototype,"weChat.rankPanel")}(weChat||(weChat={}));var weChat;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="RankPanelItemSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this)},t}(eui.ItemRenderer);e.rankPanelItem=t,__reflect(t.prototype,"weChat.rankPanelItem")}(weChat||(weChat={}));var Cmd;!function(e){var t;!function(e){e[e.Music=1]="Music",e[e.Sound=2]="Sound",e[e.Rank=3]="Rank"}(t=e.SetType||(e.SetType={}));var i;!function(e){e[e.Task_Status_Unstart=0]="Task_Status_Unstart",e[e.Task_Status_Progress=1]="Task_Status_Progress",e[e.Task_Status_Complete=2]="Task_Status_Complete",e[e.Task_Status_Received=3]="Task_Status_Received"}(i=e.TaskStatus||(e.TaskStatus={}));var n;!function(e){e[e.Shop=1]="Shop",e[e.Friend=2]="Friend",e[e.Alms=3]="Alms",e[e.Activity=4]="Activity",e[e.DaysTask=5]="DaysTask",e[e.More=6]="More",e[e.MoneyTree=7]="MoneyTree",e[e.GiftHouse=100]="GiftHouse",e[e.FriendMsg=200]="FriendMsg",e[e.FriendReq=201]="FriendReq",e[e.GetAlms=300]="GetAlms",e[e.Act_DaySign=400]="Act_DaySign",e[e.Act_TurnCard=401]="Act_TurnCard",e[e.Act_TurnTable=402]="Act_TurnTable",e[e.Task_fight=500]="Task_fight",e[e.Task_TurnTable=501]="Task_TurnTable",e[e.Task_EveryDay=502]="Task_EveryDay",e[e.Task_Once=503]="Task_Once",e[e.Task_Notice=600]="Task_Notice",e[e.Task_Charm=601]="Task_Charm",e[e.Task_NewMail=602]="Task_NewMail",e[e.Task_VIP=603]="Task_VIP",e[e.Task_MoneyTree=701]="Task_MoneyTree"}(n=e.MsgType||(e.MsgType={}));var o=function(){function e(){}return e.prototype.GetType=function(){return"Cmd.UserInfoGetLbyCmd_C"},e}();e.UserInfoGetLbyCmd_C=o,__reflect(o.prototype,"Cmd.UserInfoGetLbyCmd_C");var r=function(){function e(){}return e.prototype.GetType=function(){return"Cmd.UserInfoGetLbyCmd_C"},e}();e.UserInfoSynLobbyCmd_S=r,__reflect(r.prototype,"Cmd.UserInfoSynLobbyCmd_S");var a=function(){function e(){}return e.prototype.GetType=function(){return"Cmd.UserInfoGetLbyCmd_S"},e}();e.UserInfoGetLbyCmd_S=a,__reflect(a.prototype,"Cmd.UserInfoGetLbyCmd_S");var s=function(){function e(){}return e.prototype.GetType=function(){return"Cmd.UserRoomInfo"},e}();e.UserRoomInfo=s,__reflect(s.prototype,"Cmd.UserRoomInfo");var h=function(){function e(){}return e.prototype.GetType=function(){return"Cmd.ShopPointItem"},e}();e.ShopPointItem=h,__reflect(h.prototype,"Cmd.ShopPointItem")}(Cmd||(Cmd={})),window.Main=Main;